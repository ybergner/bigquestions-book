<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Testing for an association between two variables | Carpe Datum" />
<meta property="og:type" content="book" />



<meta name="github-repo" content="ybergner/carpe-datum" />

<meta name="author" content="Yoav Bergner" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="Testing for an association between two variables | Carpe Datum">

<title>Testing for an association between two variables | Carpe Datum</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#preface">Preface</a><ul>
<li><a href="caveat.html#caveat">Caveat</a></li>
<li class="has-sub"><a href="guiding-principles-in-this-book.html#guiding-principles-in-this-book">Guiding principles in this book</a><ul>
<li><a href="guiding-principles-in-this-book.html#question-driven">Question-driven</a></li>
<li><a href="guiding-principles-in-this-book.html#no-proofs">No proofs</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="how-many-kinds-of-people-are-there.html#how-many-kinds-of-people-are-there">How Many Kinds of People Are There?</a><ul>
<li><a href="things-are-about-to-get-meta-right-from-the-start.html#things-are-about-to-get-meta-right-from-the-start">Things are about to get meta right from the start</a></li>
</ul></li>
<li class="has-sub"><a href="1-categories.html#categories"><span class="toc-section-number">1</span> Categories, counts, and kinds</a><ul>
<li><a href="1-categories.html#two-kinds-of-people">Two Kinds of People</a></li>
<li><a href="1-categories.html#samples-and-populations-a-statistical-caveat">Samples and Populations: A Statistical Caveat</a></li>
<li><a href="1-categories.html#a-psychological-caveat">A Psychological Caveat</a></li>
<li><a href="1-categories.html#summarizing-data">Summarizing data</a></li>
<li><a href="1-categories.html#checkpoint">Checkpoint</a></li>
</ul></li>
<li class="has-sub"><a href="2-dimensions.html#dimensions"><span class="toc-section-number">2</span> Dimensions</a><ul>
<li><a href="independence-association-and-contingency.html#independence-association-and-contingency">Independence, Association, and Contingency</a></li>
<li><a href="latent-factors-and-measurement.html#latent-factors-and-measurement">Latent Factors and Measurement</a></li>
</ul></li>
<li class="has-sub"><a href="3-test-indep.html#test-indep"><span class="toc-section-number">3</span> Tests of independence: A first look starring alternate universes</a><ul>
<li><a href="rise-of-the-machines.html#rise-of-the-machines">Rise of the machines</a></li>
<li><a href="hypothesis-testing-just-happened.html#hypothesis-testing-just-happened">Hypothesis testing just happened</a></li>
<li><a href="caveats.html#caveats">Caveats</a></li>
<li class="has-sub"><a href="sampling-simulations-and-randomness.html#sampling-simulations-and-randomness">Sampling, simulations, and randomness</a><ul>
<li><a href="sampling-simulations-and-randomness.html#tossing-virtual-coins">Tossing (virtual) coins</a></li>
<li><a href="sampling-simulations-and-randomness.html#but-some-observations-do-occur-more-than-others">But some observations <em>do</em> occur more than others</a></li>
</ul></li>
<li><a href="recap.html#recap">Recap</a></li>
</ul></li>
<li class="has-sub"><a href="4-shades.html#shades"><span class="toc-section-number">4</span> (An Infinite Number of) Shades of Gray (or Brown)</a><ul>
<li class="has-sub"><a href="poopiness.html#poopiness">Poopiness</a><ul>
<li><a href="poopiness.html#mixtures">Mixtures</a></li>
</ul></li>
<li class="has-sub"><a href="crappiness.html#crappiness">Crappiness</a><ul>
<li><a href="crappiness.html#check-your-understanding">Check your understanding</a></li>
</ul></li>
</ul></li>
<li><a href="5-cut-scores-and-abnormality.html#cut-scores-and-abnormality"><span class="toc-section-number">5</span> Cut Scores and Abnormality</a></li>
<li class="has-sub"><a href="6-the-modal-american.html#the-modal-american"><span class="toc-section-number">6</span> The Modal American</a><ul>
<li><a href="6-the-modal-american.html#step-one-categories">Step one: categories</a></li>
<li><a href="6-the-modal-american.html#step-two-contingency-table">Step two: contingency table</a></li>
<li><a href="6-the-modal-american.html#exercises">Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="7-sixteen-personalities-or-five-factors.html#sixteen-personalities-or-five-factors"><span class="toc-section-number">7</span> Sixteen Personalities or Five Factors?</a><ul>
<li><a href="7-sixteen-personalities-or-five-factors.html#mbti">MBTI</a></li>
<li><a href="7-sixteen-personalities-or-five-factors.html#big-five">Big Five</a></li>
<li><a href="7-sixteen-personalities-or-five-factors.html#twenty-questions-about-extraversion">Twenty Questions (about Extraversion)</a></li>
<li><a href="7-sixteen-personalities-or-five-factors.html#but-whats-the-point">But what’s the point?</a></li>
<li><a href="still-meta-after-all-these-pages.html#still-meta-after-all-these-pages">Still meta after all these pages</a></li>
</ul></li>
<li class="has-sub"><a href="8-when-and-how-will-you-die.html#when-and-how-will-you-die"><span class="toc-section-number">8</span> When and How Will You Die?</a><ul>
<li class="has-sub"><a href="not-quite-death-but-um-rain.html#not-quite-death-but-um-rain">Not Quite Death, but, um… Rain?</a><ul>
<li><a href="not-quite-death-but-um-rain.html#stochastic-vs-deterministic-relationships">Stochastic vs Deterministic relationships</a></li>
</ul></li>
<li class="has-sub"><a href="ways-of-thinking-about-probabilistic-statements.html#ways-of-thinking-about-probabilistic-statements">Ways of thinking about probabilistic statements</a><ul>
<li><a href="ways-of-thinking-about-probabilistic-statements.html#ensembles">Ensembles</a></li>
<li><a href="ways-of-thinking-about-probabilistic-statements.html#degree-of-belief">Degree of belief</a></li>
<li><a href="ways-of-thinking-about-probabilistic-statements.html#decisions">Decisions</a></li>
</ul></li>
<li><a href="death.html#death">Death</a></li>
</ul></li>
<li class="has-sub"><a href="9-conditional-death.html#conditional-death"><span class="toc-section-number">9</span> Conditional Death</a><ul>
<li><a href="9-conditional-death.html#how-does-the-death-simulation-work">How does the death (simulation) work?</a></li>
</ul></li>
<li class="has-sub"><a href="10-somefacts.html#somefacts"><span class="toc-section-number">10</span> Some facts about Probabilities</a><ul>
<li><a href="conditional-probabilities.html#conditional-probabilities">Conditional Probabilities</a></li>
<li class="has-sub"><a href="conditional-death-again.html#conditional-death-again">Conditional death, again</a><ul>
<li><a href="conditional-death-again.html#just-to-make-things-weird">Just to make things weird</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="11-how-you-will-die-causes-or-conditions.html#how-you-will-die-causes-or-conditions"><span class="toc-section-number">11</span> How You Will Die: Causes or Conditions?</a><ul>
<li><a href="causes-of-death-colloquially.html#causes-of-death-colloquially">Causes of death, colloquially</a></li>
<li><a href="hold-my-beer.html#hold-my-beer">Hold my beer</a></li>
<li><a href="non-deterministic-causation.html#non-deterministic-causation">Non-deterministic Causation</a></li>
<li><a href="testing-for-an-association-between-two-variables.html#testing-for-an-association-between-two-variables">Testing for an association between two variables</a></li>
</ul></li>
<li class="has-sub"><a href="will-you-make-money.html#will-you-make-money">Will You Make Money?</a><ul>
<li><a href="battle-of-the-bills.html#battle-of-the-bills">Battle of the Bills</a></li>
</ul></li>
<li class="has-sub"><a href="12-betting-on-beer-or-ice-cream.html#betting-on-beer-or-ice-cream"><span class="toc-section-number">12</span> Betting on Beer (or Ice Cream)</a><ul>
<li class="has-sub"><a href="how-do-statisticians-solve-problems-like-this.html#how-do-statisticians-solve-problems-like-this">How do statisticians solve problems like this?</a><ul>
<li><a href="how-do-statisticians-solve-problems-like-this.html#the-solution-by-counting-or-combinatorics">The solution by counting, or combinatorics</a></li>
<li><a href="how-do-statisticians-solve-problems-like-this.html#the-solution-by-distribution-or-statistics">The solution by distribution, or statistics</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="13-expected-value.html#expected-value"><span class="toc-section-number">13</span> Expected Value</a><ul>
<li class="has-sub"><a href="betting-on-ice-cream.html#betting-on-ice-cream">Betting on ice cream</a><ul>
<li><a href="betting-on-ice-cream.html#by-the-statistical-power-of-grayskull">By the (Statistical) Power of Grayskull</a></li>
</ul></li>
<li class="has-sub"><a href="betting-on-your-future.html#betting-on-your-future">Betting on your Future</a><ul>
<li><a href="betting-on-your-future.html#why-why-why-multiply-ay-ay">Why why why multiply-ay-ay?</a></li>
<li><a href="betting-on-your-future.html#where-do-branching-probabilities-come-from">Where do branching probabilities come from?</a></li>
</ul></li>
</ul></li>
<li><a href="is-the-system-fair.html#is-the-system-fair">Is the System Fair?</a></li>
<li class="has-sub"><a href="14-differences-in-athletics.html#differences-in-athletics"><span class="toc-section-number">14</span> Differences in athletics</a><ul>
<li class="has-sub"><a href="are-professional-basketball-players-taller.html#are-professional-basketball-players-taller">Are professional basketball players taller?</a><ul>
<li><a href="are-professional-basketball-players-taller.html#none-of-this-is-surprising">None of this is surprising</a></li>
</ul></li>
<li><a href="surprising-differences.html#surprising-differences">Surprising differences</a></li>
<li><a href="fairness-on-trial-trans-athletes.html#fairness-on-trial-trans-athletes">Fairness on trial: trans athletes</a></li>
</ul></li>
<li class="has-sub"><a href="15-nyc-covid-19-data.html#nyc-covid-19-data"><span class="toc-section-number">15</span> NYC COVID-19 Data</a><ul>
<li><a href="prologue.html#prologue">Prologue</a></li>
<li class="has-sub"><a href="15-1-part1.html#part1"><span class="toc-section-number">15.1</span> COVID NYC</a><ul>
<li><a href="15-1-part1.html#getting-some-data">Getting some data</a></li>
<li><a href="15-1-part1.html#local-data-on-covid-from-the-city-andor-state">Local data on COVID from the city and/or state</a></li>
</ul></li>
<li class="has-sub"><a href="15-2-part2.html#part2"><span class="toc-section-number">15.2</span> Getting started with US Census data</a><ul>
<li><a href="15-2-part2.html#census-variables">Census Variables</a></li>
<li><a href="15-2-part2.html#geography-units">Geography Units</a></li>
</ul></li>
<li class="has-sub"><a href="15-3-part3.html#part3"><span class="toc-section-number">15.3</span> More (and messier) Census data</a><ul>
<li><a href="15-3-part3.html#exploring-the-acs-data">Exploring the ACS data</a></li>
</ul></li>
<li class="has-sub"><a href="15-4-zipcode.html#zipcode"><span class="toc-section-number">15.4</span> Zipcode tabulation area</a><ul>
<li><a href="15-4-zipcode.html#some-more-variables-to-play-with">Some more variables to play with</a></li>
</ul></li>
<li class="has-sub"><a href="15-5-mapviz.html#mapviz"><span class="toc-section-number">15.5</span> Visualizing data on maps</a><ul>
<li><a href="15-5-mapviz.html#shapefiles">Shapefiles</a></li>
<li><a href="15-5-mapviz.html#coloring-in-the-shapes">Coloring in the shapes</a></li>
<li><a href="15-5-mapviz.html#scatterplots">Scatterplots</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="has-sub"><a href="A-sec-randomness.html#sec:randomness"><span class="toc-section-number">A</span> Randomness</a><ul>
<li><a href="A-1-defining-random-processes.html#defining-random-processes"><span class="toc-section-number">A.1</span> Defining random processes</a></li>
<li><a href="A-2-predictions-about-random-events.html#predictions-about-random-events"><span class="toc-section-number">A.2</span> Predictions about random events</a></li>
<li><a href="A-3-modification-for-continuous-observations.html#modification-for-continuous-observations"><span class="toc-section-number">A.3</span> Modification for continuous observations</a></li>
</ul></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="testing-for-an-association-between-two-variables" class="section level2 unnumbered">
<h2>Testing for an association between two variables</h2>
<p>Let’s focus on the first question: How big a difference does there have to be between the cancer rates for smokers and non-smokers for us to be convinced that there is an association between smoking and cancer? Our approach to answering this question will be very similar to the one we used in Chapter <a href="3-test-indep.html#test-indep">3</a> where we were considering associations between two-types-of-people questions. The method for establishing association is quite general.</p>
<p>Caveat: we are going to vastly oversimplify the problem here and use made up numbers. Smoking is not a dichotomous variable. People can smoke more or less heavily and for different durations. They may have already quit or be active smokers. For this worked example, we will imagine that we are sampling people between the ages of 50 and 75. We will operationalize smokers as heavy smokers: people who smoked the equivalent of at least 10 cigarettes a day for at least 20 years.</p>
<p>Suppose that we are able to obtain a randomly selected sample of 1000 people in this age group. For each one, the following information is available: a) whether the person is/was a heavy smoker and b) whether the person has ever been diagnosed with cancer. The beginning of our dataset might look something like this:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">Cancer?</th>
<th align="center">Smoke?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Person 1</td>
<td align="center">No</td>
<td align="center">No</td>
</tr>
<tr class="even">
<td>Person 2</td>
<td align="center">No</td>
<td align="center">Yes</td>
</tr>
<tr class="odd">
<td>Person 3</td>
<td align="center">Yes</td>
<td align="center">No</td>
</tr>
<tr class="even">
<td>Person 4</td>
<td align="center">No</td>
<td align="center">No</td>
</tr>
<tr class="odd">
<td>Person 5</td>
<td align="center">No</td>
<td align="center">Yes</td>
</tr>
<tr class="even">
<td>Person 6</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
</tr>
</tbody>
</table>
<p>As a first step, you tabulate the data and get the following contingency table:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">Cancer: Yes</th>
<th align="center">Cancer: No</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Smoke: Yes</td>
<td align="center">46</td>
<td align="center">204</td>
</tr>
<tr class="even">
<td>Smoke: No</td>
<td align="center">93</td>
<td align="center">657</td>
</tr>
</tbody>
</table>
<p>Then, you use the table to estimate the following:</p>
<p><span class="math display">\[P(\text{Cancer}|\text{Smoke})=\frac{46}{46+204}=0.184\]</span></p>
<p><span class="math display">\[P(\text{Cancer}|\text{Not Smoke})=\frac{93}{93+657}=0.124\]</span></p>
<p>You might say that these numbers suggest an association (i.e., dependence) between smoking and cancer: Within this sample, a higher proportion of smokers were diagnosed with cancer than non-smokers. But is this enough of a difference to convince you that, if you went out and found 1000 new (random) people, you would still observe a difference of this magnitude?</p>
<p>One way to <em>start</em> trying to answer this question is to consider the following thought experiment: imagine that, among all people in the world, there is NOT a higher incidence of cancer among smokers (as compared to non-smokers). If that were the case, you would expect to see</p>
<p><span class="math display">\[P(\text{Cancer}|\text{Smoke})=P(\text{Cancer}|\text{Not Smoke}).\]</span></p>
<p>Or, written slightly differently:</p>
<p><span class="math display">\[P(\text{Cancer}|\text{Smoke})-P(\text{Cancer}|\text{Not Smoke})=0.\]</span></p>
<p>In comparison, you observed the following in your sample:</p>
<p><span class="math display">\[P(\text{Cancer}|\text{Smoke})-P(\text{Cancer}|\text{Not Smoke})=0.184-0.124=0.06.\]</span></p>
<p>So, you could pose the following question: what is the probability that, among the whole population, smokers do not have higher risk of cancer; but, among the random sample of 1000 people that you observed, there is a 6% (or greater) increased incidence of cancer among smokers as compared to non-smokers? This type of question is the basis for <strong>hypothesis testing</strong>. Often, in hypothesis testing, we form a <strong>null hypothesis</strong> (in this case, the null hypothesis might be that smokers and non-smokers have equal cancer incidence among the full population) and <strong>alternative hypothesis</strong> (in this case, the alternative hypothesis might be that smokers have at least 6% higher risk of cancer than non-smokers).</p>
<!-- If you are interested in learning more about how statisticians use probability distributions to answer these types of questions, there are plenty of resources online. In this book, however, we will attempt to answer this question using a simulation. -->
<p>Based on the sample you observed, you could estimate that approximately <span class="math inline">\(\frac{46+204}{1000}*100=25\)</span> percent of the population smokes and approximately <span class="math inline">\(\frac{46+93}{1000}*100=13.9\)</span> percent of the population has been diagnosed with cancer. If there is no real difference in cancer incidence among smokers and non-smokers, then these two variables are independent: as though 25% of your sample randomly decided to smoke, and 13.9% were randomly diagnosed with cancer.</p>
<p>It is easy to simulate datasets under this assumption. In two completely separate (independent) steps, we will randomly assign to each of our 1000 people, a 25% chance of being a heavy smoker and a 13.9% chance of getting cancer. In Chapter <a href="3-test-indep.html#test-indep">3</a>, we imagined starting with a fixed number of responses (e.g., smoker/non-smoker), shuffling those responses, and then redistributing the values among our virtual subjects. The code below actually does something different. It will draw values with replacement for each of the two variables. This means that in each replication, we will not actually have exactly 250 smokers and 139 cancers. The numbers will fluctuate somewhat in each simulated dataset.</p>
<p>After we generate our simulated datasets, we can calculate <span class="math inline">\(P(\text{Cancer}|\text{Smoke})-P(\text{Cancer}|\text{Not Smoke})\)</span> and observe what range of values occurs. We will be particularly interested in the proportion of the time that this difference is greater than or equal to <span class="math inline">\(0.06\)</span>. That was our observed value. And in this simulation, we know that the two variables are independent. Thus, we are quantifying the chance of observing such a difference in outcomes due to random chance.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">5123</span>)</a>
<a class="sourceLine" id="cb47-2" data-line-number="2"></a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="co">#set some number of iterations/replications</span></a>
<a class="sourceLine" id="cb47-4" data-line-number="4">nIter =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb47-5" data-line-number="5"></a>
<a class="sourceLine" id="cb47-6" data-line-number="6"><span class="co">#create vector to save differences in proportions</span></a>
<a class="sourceLine" id="cb47-7" data-line-number="7">differences =<span class="st"> </span><span class="kw">vector</span>(<span class="dt">length =</span> nIter) </a>
<a class="sourceLine" id="cb47-8" data-line-number="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nIter){ <span class="co">#repeat the following process nIter times</span></a>
<a class="sourceLine" id="cb47-9" data-line-number="9"></a>
<a class="sourceLine" id="cb47-10" data-line-number="10">  <span class="co">#create some fake data and save it as &quot;fakedata&quot;</span></a>
<a class="sourceLine" id="cb47-11" data-line-number="11">  fakedata =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Smoke =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>, <span class="st">&quot;N&quot;</span>), <span class="dt">size=</span><span class="dv">1000</span>, </a>
<a class="sourceLine" id="cb47-12" data-line-number="12">                                       <span class="dt">prob=</span><span class="kw">c</span>(.<span class="dv">25</span>, <span class="fl">.75</span>), <span class="dt">replace =</span> T),</a>
<a class="sourceLine" id="cb47-13" data-line-number="13">                        <span class="dt">Cancer =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>, <span class="st">&quot;N&quot;</span>), <span class="dt">size=</span><span class="dv">1000</span>, </a>
<a class="sourceLine" id="cb47-14" data-line-number="14">                                        <span class="dt">prob=</span><span class="kw">c</span>(.<span class="dv">139</span>, <span class="fl">.861</span>), <span class="dt">replace =</span> T))</a>
<a class="sourceLine" id="cb47-15" data-line-number="15"></a>
<a class="sourceLine" id="cb47-16" data-line-number="16">  <span class="co">#use the fake data to calculate P(cancer|smoke)</span></a>
<a class="sourceLine" id="cb47-17" data-line-number="17">  CgivenS =<span class="st"> </span><span class="kw">table</span>(fakedata)[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">table</span>(fakedata)[<span class="dv">2</span>,])</a>
<a class="sourceLine" id="cb47-18" data-line-number="18"></a>
<a class="sourceLine" id="cb47-19" data-line-number="19">  <span class="co">#use the fake data to calculate P(cancer|not smoke)</span></a>
<a class="sourceLine" id="cb47-20" data-line-number="20">  CgivenNS =<span class="st"> </span><span class="kw">table</span>(fakedata)[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">table</span>(fakedata)[<span class="dv">1</span>,])</a>
<a class="sourceLine" id="cb47-21" data-line-number="21"></a>
<a class="sourceLine" id="cb47-22" data-line-number="22">  <span class="co">#save P(cancer|smoke) - P(cancer|not smoke) in the ith location of differences</span></a>
<a class="sourceLine" id="cb47-23" data-line-number="23">  differences[i] &lt;-<span class="st"> </span>CgivenS <span class="op">-</span><span class="st"> </span>CgivenNS</a>
<a class="sourceLine" id="cb47-24" data-line-number="24">}</a>
<a class="sourceLine" id="cb47-25" data-line-number="25"></a>
<a class="sourceLine" id="cb47-26" data-line-number="26"><span class="co">#calculate proportion of differences greater than or equal to .06</span></a>
<a class="sourceLine" id="cb47-27" data-line-number="27">propGreater &lt;-<span class="st"> </span><span class="kw">sum</span>(differences <span class="op">&gt;=</span><span class="st"> </span><span class="fl">.06</span>)<span class="op">/</span>nIter</a>
<a class="sourceLine" id="cb47-28" data-line-number="28"></a>
<a class="sourceLine" id="cb47-29" data-line-number="29"><span class="co">#plot a histogram of the differences with a red vertical line at .06</span></a>
<a class="sourceLine" id="cb47-30" data-line-number="30"><span class="kw">hist</span>(differences, <span class="dt">main=</span><span class="st">&quot;Histogram of P(cancer|smoke) - P(cancer|not smoke)&quot;</span>,</a>
<a class="sourceLine" id="cb47-31" data-line-number="31">     <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>))</a>
<a class="sourceLine" id="cb47-32" data-line-number="32"><span class="kw">abline</span>(<span class="dt">v=</span>.<span class="dv">06</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb47-33" data-line-number="33"><span class="kw">text</span>(<span class="fl">0.09</span>, nIter<span class="op">/</span><span class="dv">10</span>, <span class="kw">paste0</span>(propGreater<span class="op">*</span><span class="dv">100</span>,<span class="st">&quot;% of cases&quot;</span>))</a></code></pre></div>
<p><img src="carpedatum_files/figure-html/unnamed-chunk-20-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As you might expect, the histogram of simulated differences (<span class="math inline">\(P(\text{Cancer}|\text{Smoke}) - P(\text{Cancer}|\text{Not Smoke})\)</span>) is centered around zero. If there’s no real difference, then you should expect to observe (close to) zero differences among any random sample of 1000 people. That said, you’ll see from the histogram that it is still possible, by random chance, to observe a difference as large or greater than 6%.</p>
<p>In fact, in our simulation, this happened 3 times (3% of the time). Remember that our simulation was carried out assuming independence, in which case there should be no difference. So we might interpret our findings as follows: there is a relatively low probability of observing <span class="math inline">\(P(\text{Cancer}|\text{Smoke}) - P(\text{Cancer}|\text{Not Smoke})\ge .06\)</span> in a sample of 1000 people if it were truly the case that this difference was zero.</p>
<!-- ## Association is necessary but not sufficient -->
<!-- To review, some events in life are connected deterministically  -->
<!-- At this point you should be feelin -->
<!-- We've made some good progress, but you might still have some concerns: 1) there is always some risk that there is no real difference in cancer incidence among these two groups, but you observed a large difference in your sample nonetheless and 2) even if there is a real difference, there are a lot of possible reasons that this difference could exist without a direct causal relationship. That said, if you can convince yourself that there is a very small probability that the association you observed could have occurred randomly, then you might want to move on to a new question: can you explain why is there an association? -->

</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="non-deterministic-causation.html"><button class="btn btn-default">Previous</button></a>
<a href="will-you-make-money.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
