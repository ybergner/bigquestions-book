<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="15.3 More (and messier) Census data | Carpe Datum" />
<meta property="og:type" content="book" />





<meta name="author" content="Yoav Bergner" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="15.3 More (and messier) Census data | Carpe Datum">

<title>15.3 More (and messier) Census data | Carpe Datum</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#preface">Preface</a><ul>
<li><a href="caveat.html#caveat">Caveat</a></li>
<li class="has-sub"><a href="guiding-principles-in-this-book.html#guiding-principles-in-this-book">Guiding principles in this book</a><ul>
<li><a href="guiding-principles-in-this-book.html#question-driven">Question-driven</a></li>
<li><a href="guiding-principles-in-this-book.html#no-proofs">No proofs</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="how-many-kinds-of-people-are-there.html#how-many-kinds-of-people-are-there">How Many Kinds of People Are There?</a><ul>
<li><a href="things-are-about-to-get-meta-right-from-the-start.html#things-are-about-to-get-meta-right-from-the-start">Things are about to get meta right from the start</a></li>
</ul></li>
<li class="has-sub"><a href="1-categories.html#categories"><span class="toc-section-number">1</span> Categories, counts, and kinds</a><ul>
<li><a href="1-categories.html#two-kinds-of-people">Two Kinds of People</a></li>
<li><a href="1-categories.html#samples-and-populations-a-statistical-caveat">Samples and Populations: A Statistical Caveat</a></li>
<li><a href="1-categories.html#a-psychological-caveat">A Psychological Caveat</a></li>
<li><a href="1-categories.html#summarizing-data">Summarizing data</a></li>
<li><a href="1-categories.html#checkpoint">Checkpoint</a></li>
</ul></li>
<li class="has-sub"><a href="2-dimensions.html#dimensions"><span class="toc-section-number">2</span> Dimensions</a><ul>
<li><a href="independence-association-and-contingency.html#independence-association-and-contingency">Independence, Association, and Contingency</a></li>
<li><a href="latent-factors-and-measurement.html#latent-factors-and-measurement">Latent Factors and Measurement</a></li>
</ul></li>
<li class="has-sub"><a href="3-test-indep.html#test-indep"><span class="toc-section-number">3</span> Tests of independence: A first look starring alternate universes</a><ul>
<li><a href="rise-of-the-machines.html#rise-of-the-machines">Rise of the machines</a></li>
<li><a href="hypothesis-testing-just-happened.html#hypothesis-testing-just-happened">Hypothesis testing just happened</a></li>
<li><a href="caveats.html#caveats">Caveats</a></li>
<li class="has-sub"><a href="sampling-simulations-and-randomness.html#sampling-simulations-and-randomness">Sampling, simulations, and randomness</a><ul>
<li><a href="sampling-simulations-and-randomness.html#tossing-virtual-coins">Tossing (virtual) coins</a></li>
<li><a href="sampling-simulations-and-randomness.html#but-some-observations-do-occur-more-than-others">But some observations <em>do</em> occur more than others</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="4-shades.html#shades"><span class="toc-section-number">4</span> (An Infinite Number of) Shades of Gray (or Brown)</a><ul>
<li class="has-sub"><a href="poopiness.html#poopiness">Poopiness</a><ul>
<li><a href="poopiness.html#mixtures">Mixtures</a></li>
</ul></li>
<li class="has-sub"><a href="crappiness.html#crappiness">Crappiness</a><ul>
<li><a href="crappiness.html#check-your-understanding">Check your understanding</a></li>
</ul></li>
</ul></li>
<li><a href="5-cut-scores-and-abnormality.html#cut-scores-and-abnormality"><span class="toc-section-number">5</span> Cut Scores and Abnormality</a></li>
<li class="has-sub"><a href="6-the-modal-american.html#the-modal-american"><span class="toc-section-number">6</span> The Modal American</a><ul>
<li><a href="6-the-modal-american.html#step-one-categories">Step one: categories</a></li>
<li><a href="6-the-modal-american.html#step-two-contingency-table">Step two: contingency table</a></li>
<li><a href="6-the-modal-american.html#exercises">Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="7-sixteen-personalities-or-five-factors.html#sixteen-personalities-or-five-factors"><span class="toc-section-number">7</span> Sixteen Personalities or Five Factors?</a><ul>
<li><a href="7-sixteen-personalities-or-five-factors.html#mbti">MBTI</a></li>
<li><a href="7-sixteen-personalities-or-five-factors.html#big-five">Big Five</a></li>
<li><a href="7-sixteen-personalities-or-five-factors.html#twenty-questions-about-extraversion">Twenty Questions (about Extraversion)</a></li>
<li><a href="7-sixteen-personalities-or-five-factors.html#but-whats-the-point">But what’s the point?</a></li>
<li><a href="still-meta-after-all-these-pages.html#still-meta-after-all-these-pages">Still meta after all these pages</a></li>
</ul></li>
<li class="has-sub"><a href="8-when-and-how-will-you-die.html#when-and-how-will-you-die"><span class="toc-section-number">8</span> When and How Will You Die?</a><ul>
<li class="has-sub"><a href="not-quite-death-but-um-rain.html#not-quite-death-but-um-rain">Not Quite Death, but, um… Rain?</a><ul>
<li><a href="not-quite-death-but-um-rain.html#stochastic-vs-deterministic-relationships">Stochastic vs Deterministic relationships</a></li>
</ul></li>
<li class="has-sub"><a href="ways-of-thinking-about-probabilistic-statements.html#ways-of-thinking-about-probabilistic-statements">Ways of thinking about probabilistic statements</a><ul>
<li><a href="ways-of-thinking-about-probabilistic-statements.html#ensembles">Ensembles</a></li>
<li><a href="ways-of-thinking-about-probabilistic-statements.html#degree-of-belief">Degree of belief</a></li>
<li><a href="ways-of-thinking-about-probabilistic-statements.html#decisions">Decisions</a></li>
</ul></li>
<li><a href="death.html#death">Death</a></li>
</ul></li>
<li class="has-sub"><a href="9-conditional-death.html#conditional-death"><span class="toc-section-number">9</span> Conditional Death</a><ul>
<li><a href="9-conditional-death.html#how-does-the-death-simulation-work">How does the death (simulation) work?</a></li>
</ul></li>
<li class="has-sub"><a href="10-somefacts.html#somefacts"><span class="toc-section-number">10</span> Some facts about Probabilities</a><ul>
<li><a href="conditional-probabilities.html#conditional-probabilities">Conditional Probabilities</a></li>
<li class="has-sub"><a href="conditional-death-again.html#conditional-death-again">Conditional death, again</a><ul>
<li><a href="conditional-death-again.html#just-to-make-things-weird">Just to make things weird</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="11-how-you-will-die-causes-or-conditions.html#how-you-will-die-causes-or-conditions"><span class="toc-section-number">11</span> How You Will Die: Causes or Conditions?</a><ul>
<li><a href="causes-of-death-colloquially.html#causes-of-death-colloquially">Causes of death, colloquially</a></li>
<li><a href="hold-my-beer.html#hold-my-beer">Hold my beer</a></li>
<li><a href="non-deterministic-causation.html#non-deterministic-causation">Non-deterministic Causation</a></li>
<li><a href="testing-for-an-association-between-two-variables.html#testing-for-an-association-between-two-variables">Testing for an association between two variables</a></li>
</ul></li>
<li class="has-sub"><a href="will-you-make-money.html#will-you-make-money">Will You Make Money?</a><ul>
<li><a href="battle-of-the-bills.html#battle-of-the-bills">Battle of the Bills</a></li>
</ul></li>
<li class="has-sub"><a href="12-betting-on-beer-or-ice-cream.html#betting-on-beer-or-ice-cream"><span class="toc-section-number">12</span> Betting on Beer (or Ice Cream)</a><ul>
<li class="has-sub"><a href="how-do-statisticians-solve-problems-like-this.html#how-do-statisticians-solve-problems-like-this">How do statisticians solve problems like this?</a><ul>
<li><a href="how-do-statisticians-solve-problems-like-this.html#the-solution-by-counting-or-combinatorics">The solution by counting, or combinatorics</a></li>
<li><a href="how-do-statisticians-solve-problems-like-this.html#the-solution-by-distribution-or-statistics">The solution by distribution, or statistics</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="13-expected-value.html#expected-value"><span class="toc-section-number">13</span> Expected Value</a><ul>
<li class="has-sub"><a href="betting-on-ice-cream.html#betting-on-ice-cream">Betting on ice cream</a><ul>
<li><a href="betting-on-ice-cream.html#by-the-statistical-power-of-grayskull">By the (Statistical) Power of Grayskull</a></li>
</ul></li>
<li class="has-sub"><a href="betting-on-your-future.html#betting-on-your-future">Betting on your Future</a><ul>
<li><a href="betting-on-your-future.html#why-why-why-multiply-ay-ay">Why why why multiply-ay-ay?</a></li>
<li><a href="betting-on-your-future.html#where-do-branching-probabilities-come-from">Where do branching probabilities come from?</a></li>
</ul></li>
</ul></li>
<li><a href="is-the-system-fair.html#is-the-system-fair">Is the System Fair?</a></li>
<li class="has-sub"><a href="14-differences-in-athletics.html#differences-in-athletics"><span class="toc-section-number">14</span> Differences in athletics</a><ul>
<li class="has-sub"><a href="are-professional-basketball-players-taller.html#are-professional-basketball-players-taller">Are professional basketball players taller?</a><ul>
<li><a href="are-professional-basketball-players-taller.html#none-of-this-is-surprising">None of this is surprising</a></li>
</ul></li>
<li><a href="surprising-differences.html#surprising-differences">Surprising differences</a></li>
<li><a href="fairness-on-trial-trans-athletes.html#fairness-on-trial-trans-athletes">Fairness on trial: trans athletes</a></li>
</ul></li>
<li class="has-sub"><a href="15-nyc-covid-19-data.html#nyc-covid-19-data"><span class="toc-section-number">15</span> NYC COVID-19 Data</a><ul>
<li><a href="prologue.html#prologue">Prologue</a></li>
<li class="has-sub"><a href="15-1-part1.html#part1"><span class="toc-section-number">15.1</span> COVID NYC</a><ul>
<li><a href="15-1-part1.html#getting-some-data">Getting some data</a></li>
<li><a href="15-1-part1.html#local-data-on-covid-from-the-city-andor-state">Local data on COVID from the city and/or state</a></li>
</ul></li>
<li class="has-sub"><a href="15-2-part2.html#part2"><span class="toc-section-number">15.2</span> Getting started with US Census data</a><ul>
<li><a href="15-2-part2.html#census-variables">Census Variables</a></li>
<li><a href="15-2-part2.html#geography-units">Geography Units</a></li>
</ul></li>
<li class="has-sub"><a href="15-3-part3.html#part3"><span class="toc-section-number">15.3</span> More (and messier) Census data</a><ul>
<li><a href="15-3-part3.html#exploring-the-acs-data">Exploring the ACS data</a></li>
</ul></li>
<li class="has-sub"><a href="15-4-zipcode.html#zipcode"><span class="toc-section-number">15.4</span> Zipcode tabulation area</a><ul>
<li><a href="15-4-zipcode.html#some-more-variables-to-play-with">Some more variables to play with</a></li>
</ul></li>
<li class="has-sub"><a href="15-5-mapviz.html#mapviz"><span class="toc-section-number">15.5</span> Visualizing data on maps</a><ul>
<li><a href="15-5-mapviz.html#shapefiles">Shapefiles</a></li>
<li><a href="15-5-mapviz.html#coloring-in-the-shapes">Coloring in the shapes</a></li>
<li><a href="15-5-mapviz.html#scatterplots">Scatterplots</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="has-sub"><a href="A-sec-randomness.html#sec:randomness"><span class="toc-section-number">A</span> Randomness</a><ul>
<li><a href="A-1-defining-random-processes.html#defining-random-processes"><span class="toc-section-number">A.1</span> Defining random processes</a></li>
<li><a href="A-2-predictions-about-random-events.html#predictions-about-random-events"><span class="toc-section-number">A.2</span> Predictions about random events</a></li>
<li><a href="A-3-modification-for-continuous-observations.html#modification-for-continuous-observations"><span class="toc-section-number">A.3</span> Modification for continuous observations</a></li>
</ul></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="part3" class="section level2">
<h2><span class="header-section-number">15.3</span> More (and messier) Census data</h2>
<div id="exploring-the-acs-data" class="section level3 unnumbered">
<h3>Exploring the ACS data</h3>
<p>So far, we have been selecting one or two variables at a time, because we knew what we were looking for. Sometimes, though, you’re not exactly sure what variables are in the data. Moreoever, since many of the ACS tables combine categories (such as SEX BY AGE), the number of variables grows exponentially (e.g., as the number of SEX categories times the number of AGE categories). Add to that the margin-of-error and annotation variables, and the list gets overwhelming fast.</p>
<p>Even data from the SEX BY AGE group (B01001), which seems simple, is rather complicated-looking! I will walk through it deliberately, as I would do if I were exploring the data for the first time and not sure what I was going to find.</p>
<p>First, I will use the function <code>listCensusMetadata</code> to request all of the variables in the group B01001 and see what we see.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1"><span class="co"># a list of groups can be found here; there are 1135 of them!</span></a>
<a class="sourceLine" id="cb132-2" data-line-number="2"><span class="co"># acs_groups &lt;- listCensusMetadata(name = &quot;acs/acs5&quot;, vintage = 2018, type = &quot;groups&quot;)</span></a>
<a class="sourceLine" id="cb132-3" data-line-number="3"><span class="co"># head(acs_groups)</span></a>
<a class="sourceLine" id="cb132-4" data-line-number="4"></a>
<a class="sourceLine" id="cb132-5" data-line-number="5"><span class="co"># here are the variables in the SEX BY AGE group</span></a>
<a class="sourceLine" id="cb132-6" data-line-number="6">group_B01001 &lt;-<span class="st"> </span><span class="kw">listCensusMetadata</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb132-7" data-line-number="7">                                   <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb132-8" data-line-number="8">                                   <span class="dt">type =</span> <span class="st">&quot;variables&quot;</span>,</a>
<a class="sourceLine" id="cb132-9" data-line-number="9">                                   <span class="dt">group =</span> <span class="st">&quot;B01001&quot;</span>)</a>
<a class="sourceLine" id="cb132-10" data-line-number="10"><span class="kw">head</span>(group_B01001[<span class="kw">order</span>(group_B01001<span class="op">$</span>name),], <span class="dv">15</span>)</a></code></pre></div>
<pre><code>##             name                                                     label
## 139  B01001_001E                                           Estimate!!Total
## 41  B01001_001EA                             Annotation of Estimate!!Total
## 140  B01001_001M                                    Margin of Error!!Total
## 42  B01001_001MA                      Annotation of Margin of Error!!Total
## 137  B01001_002E                                     Estimate!!Total!!Male
## 53  B01001_002EA                       Annotation of Estimate!!Total!!Male
## 138  B01001_002M                              Margin of Error!!Total!!Male
## 54  B01001_002MA                Annotation of Margin of Error!!Total!!Male
## 143  B01001_003E                      Estimate!!Total!!Male!!Under 5 years
## 50  B01001_003EA        Annotation of Estimate!!Total!!Male!!Under 5 years
## 144  B01001_003M               Margin of Error!!Total!!Male!!Under 5 years
## 51  B01001_003MA Annotation of Margin of Error!!Total!!Male!!Under 5 years
## 141  B01001_004E                       Estimate!!Total!!Male!!5 to 9 years
## 52  B01001_004EA         Annotation of Estimate!!Total!!Male!!5 to 9 years
## 142  B01001_004M                Margin of Error!!Total!!Male!!5 to 9 years
##     predicateType  group limit predicateOnly    concept
## 139           int B01001     0          TRUE SEX BY AGE
## 41         string B01001     0          TRUE       &lt;NA&gt;
## 140           int B01001     0          TRUE SEX BY AGE
## 42         string B01001     0          TRUE       &lt;NA&gt;
## 137           int B01001     0          TRUE SEX BY AGE
## 53         string B01001     0          TRUE       &lt;NA&gt;
## 138           int B01001     0          TRUE SEX BY AGE
## 54         string B01001     0          TRUE       &lt;NA&gt;
## 143           int B01001     0          TRUE SEX BY AGE
## 50         string B01001     0          TRUE       &lt;NA&gt;
## 144           int B01001     0          TRUE SEX BY AGE
## 51         string B01001     0          TRUE       &lt;NA&gt;
## 141           int B01001     0          TRUE SEX BY AGE
## 52         string B01001     0          TRUE       &lt;NA&gt;
## 142           int B01001     0          TRUE SEX BY AGE</code></pre>
<p>Ugh. Note that our table of variables here includes variable name, label, and type. For type, we have “int” for integers (numbers) and “string” which is the computational shorthand for “string of characters.” This is the variable-type used for words and sentences as well as passwords or other random strings of characters.</p>
<p>To make the results more readable, we can try identify the pattern in the order of the variables. First, let’s observe the following. The numbers after the group name are just increasing from 001, 002, and so on. We might want to look at the middle of this list, e.g, from 020 to 030, which we can do as follows:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1">myVars &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;B01001_0&quot;</span>,<span class="kw">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="dv">20</span><span class="op">:</span><span class="dv">30</span>), <span class="st">&quot;E&quot;</span>)</a>
<a class="sourceLine" id="cb134-2" data-line-number="2">group_B01001 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(name <span class="op">%in%</span><span class="st"> </span>myVars) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)</a></code></pre></div>
<pre><code>##           name                                    label predicateType  group
## 1  B01001_020E   Estimate!!Total!!Male!!65 and 66 years           int B01001
## 2  B01001_021E    Estimate!!Total!!Male!!67 to 69 years           int B01001
## 3  B01001_022E    Estimate!!Total!!Male!!70 to 74 years           int B01001
## 4  B01001_023E    Estimate!!Total!!Male!!75 to 79 years           int B01001
## 5  B01001_024E    Estimate!!Total!!Male!!80 to 84 years           int B01001
## 6  B01001_025E Estimate!!Total!!Male!!85 years and over           int B01001
## 7  B01001_026E                  Estimate!!Total!!Female           int B01001
## 8  B01001_027E   Estimate!!Total!!Female!!Under 5 years           int B01001
## 9  B01001_028E    Estimate!!Total!!Female!!5 to 9 years           int B01001
## 10 B01001_029E  Estimate!!Total!!Female!!10 to 14 years           int B01001
## 11 B01001_030E  Estimate!!Total!!Female!!15 to 17 years           int B01001
##    limit predicateOnly    concept
## 1      0          TRUE SEX BY AGE
## 2      0          TRUE SEX BY AGE
## 3      0          TRUE SEX BY AGE
## 4      0          TRUE SEX BY AGE
## 5      0          TRUE SEX BY AGE
## 6      0          TRUE SEX BY AGE
## 7      0          TRUE SEX BY AGE
## 8      0          TRUE SEX BY AGE
## 9      0          TRUE SEX BY AGE
## 10     0          TRUE SEX BY AGE
## 11     0          TRUE SEX BY AGE</code></pre>
<p>We’ve learned the following. The variable names (after the total) begin with males. First all males, then males by increasing age group. The females. Although it looks like it from this sample, the age groups are not all in intervals of 5 years. There are groups of three, two, and even one (e.g., 15-17, 18-19, 20 years). I’m not sure why.</p>
<p>Suppose we wanted to extract the percentage of the population over the age of 65. From this table we would need to do the following</p>
<ul>
<li>add up the counts of males in each of the intervals over 65
<ul>
<li>B01001_020E + B01001_021E + … + B01001_025E</li>
</ul></li>
<li>add to this the counts of females in the same age intervals
<ul>
<li>B01001_044E + B01001_045E + … + B01001_049E</li>
</ul></li>
<li>divide by the total
<ul>
<li>B01001_001E</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">maleOver65Vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;B01001_020E&quot;</span>,<span class="st">&quot;B01001_021E&quot;</span>,<span class="st">&quot;B01001_022E&quot;</span>,<span class="st">&quot;B01001_023E&quot;</span>,</a>
<a class="sourceLine" id="cb136-2" data-line-number="2">                    <span class="st">&quot;B01001_024E&quot;</span>,<span class="st">&quot;B01001_025E&quot;</span>)</a>
<a class="sourceLine" id="cb136-3" data-line-number="3">femaleOver65Vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;B01001_044E&quot;</span>,<span class="st">&quot;B01001_045E&quot;</span>,<span class="st">&quot;B01001_046E&quot;</span>,<span class="st">&quot;B01001_047E&quot;</span>,</a>
<a class="sourceLine" id="cb136-4" data-line-number="4">                      <span class="st">&quot;B01001_048E&quot;</span>,<span class="st">&quot;B01001_049E&quot;</span>)</a>
<a class="sourceLine" id="cb136-5" data-line-number="5">Total_PopVar &lt;-<span class="st"> &quot;B01001_001E&quot;</span></a>
<a class="sourceLine" id="cb136-6" data-line-number="6">acs_boro_over65 &lt;-<span class="st"> </span><span class="kw">getCensus</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb136-7" data-line-number="7">                           <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb136-8" data-line-number="8">                           <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;NAME&quot;</span>, </a>
<a class="sourceLine" id="cb136-9" data-line-number="9">                                    maleOver65Vars,femaleOver65Vars, Total_PopVar),</a>
<a class="sourceLine" id="cb136-10" data-line-number="10">                           <span class="dt">region =</span> <span class="st">&quot;county:005,047,061,081,085&quot;</span>,</a>
<a class="sourceLine" id="cb136-11" data-line-number="11">                           <span class="dt">regionin =</span> <span class="st">&quot;state:36&quot;</span>, <span class="dt">key =</span> myKey</a>
<a class="sourceLine" id="cb136-12" data-line-number="12">                         )</a>
<a class="sourceLine" id="cb136-13" data-line-number="13"></a>
<a class="sourceLine" id="cb136-14" data-line-number="14">proportionOver65 &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">rowSums</span>(acs_boro_over65[,<span class="dv">4</span><span class="op">:</span><span class="dv">15</span>])<span class="op">/</span>acs_boro_over65[,<span class="dv">16</span>],<span class="dv">3</span>)<span class="op">*</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb136-15" data-line-number="15">boro_over65_proportions &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Borough=</span><span class="kw">unname</span>(getBoro[acs_boro_over65<span class="op">$</span>NAME]), </a>
<a class="sourceLine" id="cb136-16" data-line-number="16">                                      <span class="dt">over65=</span>proportionOver65)</a>
<a class="sourceLine" id="cb136-17" data-line-number="17">boro_over65_proportions</a></code></pre></div>
<pre><code>##         Borough over65
## 1        Queens   14.8
## 2      Brooklyn   13.2
## 3     Manhattan   15.8
## 4 Staten Island   15.5
## 5     The Bronx   12.1</code></pre>
<p>I don’t know if you were expecting those results, but Manhattan has the highest proportion of adults over 65, while the Bronx has the lowest. We know that older adults have a higher rate of infection with COVID-19, and yet infection rates in the Bronx are much higher than in Manhattan. Clearly</p>
<p>If all of the above seems not worth the effort to get proportion over 65, you might want to just extact something like median age per geographic unit. These are variables in the SEX BY AGE group.</p>
<ul>
<li>B01002_001E Estimate!!Median age –!!Total</li>
<li>B01002_002E Estimate!!Median age –!!Male</li>
<li>B01002_003E Estimate!!Median age –!!Female</li>
</ul>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">medianSexByAge_boro &lt;-<span class="st"> </span><span class="kw">getCensus</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb138-2" data-line-number="2">                                 <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb138-3" data-line-number="3">                                 <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;NAME&quot;</span>, </a>
<a class="sourceLine" id="cb138-4" data-line-number="4">                                          <span class="st">&quot;B01002_001E&quot;</span>, <span class="st">&quot;B01002_002E&quot;</span>, <span class="st">&quot;B01002_003E&quot;</span>),</a>
<a class="sourceLine" id="cb138-5" data-line-number="5">                                 <span class="dt">region =</span> <span class="st">&quot;county:005,047,061,081,085&quot;</span>,</a>
<a class="sourceLine" id="cb138-6" data-line-number="6">                                 <span class="dt">regionin =</span> <span class="st">&quot;state:36&quot;</span>, </a>
<a class="sourceLine" id="cb138-7" data-line-number="7">                                 <span class="dt">key =</span> myKey</a>
<a class="sourceLine" id="cb138-8" data-line-number="8">                                 )</a>
<a class="sourceLine" id="cb138-9" data-line-number="9"></a>
<a class="sourceLine" id="cb138-10" data-line-number="10"><span class="co"># this is the easy but less elegant way to rename the variables</span></a>
<a class="sourceLine" id="cb138-11" data-line-number="11"><span class="co"># it works as long as you get the index numbers exactly right</span></a>
<a class="sourceLine" id="cb138-12" data-line-number="12"><span class="kw">names</span>(medianSexByAge_boro)[<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Median_Age&quot;</span>, <span class="st">&quot;Median_Age_Male&quot;</span>,<span class="st">&quot;Median_Age_Female&quot;</span>)</a>
<a class="sourceLine" id="cb138-13" data-line-number="13">medianSexByAge_boro</a></code></pre></div>
<pre><code>##   state county                      NAME Median_Age Median_Age_Male
## 1    36    081   Queens County, New York       38.7            37.2
## 2    36    047    Kings County, New York       35.1            33.5
## 3    36    061 New York County, New York       37.3            36.7
## 4    36    085 Richmond County, New York       40.0            38.3
## 5    36    005    Bronx County, New York       33.9            31.7
##   Median_Age_Female
## 1              40.0
## 2              36.4
## 3              37.9
## 4              41.3
## 5              35.9</code></pre>
<p>Interestingly, the medianAge puts Staten Island and Queens as older than Manhattan. So median age and proportion over 65 do not rank the Boroughs the same after all.</p>
<p>To match the NYC race-level data we will need these categories of Race/Ethnicity</p>
<ul>
<li>All Hispanic</li>
<li>Non-Hispanic/Latino: Black,African American</li>
<li>Non-Hispanic/Latino: White</li>
<li>Non-Hispanic/Latino: Asian</li>
<li>Non-Hispanic/Latino: Other</li>
</ul>
<p>First we need to find the necessary race variables. The Census organizes race information in different variable groups, some of which separate out Hispanic or Latino origin (B03002) and some which do not (B02001). We will use the first one, again to match the way NYC has been reporting health data.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1">group_B03002 &lt;-<span class="st"> </span><span class="kw">listCensusMetadata</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb140-2" data-line-number="2">                                   <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb140-3" data-line-number="3">                                   <span class="dt">type =</span> <span class="st">&quot;variables&quot;</span>,</a>
<a class="sourceLine" id="cb140-4" data-line-number="4">                                   <span class="dt">group =</span> <span class="st">&quot;B03002&quot;</span>)</a>
<a class="sourceLine" id="cb140-5" data-line-number="5"><span class="kw">head</span>(group_B03002[<span class="kw">order</span>(group_B03002<span class="op">$</span>name),], <span class="dv">20</span>)</a></code></pre></div>
<pre><code>##            name
## 29  B03002_001E
## 67 B03002_001EA
## 30  B03002_001M
## 68 B03002_001MA
## 37  B03002_002E
## 70 B03002_002EA
## 38  B03002_002M
## 69 B03002_002MA
## 35  B03002_003E
## 78 B03002_003EA
## 36  B03002_003M
## 77 B03002_003MA
## 33  B03002_004E
## 80 B03002_004EA
## 34  B03002_004M
## 79 B03002_004MA
## 31  B03002_005E
## 82 B03002_005EA
## 32  B03002_005M
## 81 B03002_005MA
##                                                                                                    label
## 29                                                                                       Estimate!!Total
## 67                                                                         Annotation of Estimate!!Total
## 30                                                                                Margin of Error!!Total
## 68                                                                  Annotation of Margin of Error!!Total
## 37                                                               Estimate!!Total!!Not Hispanic or Latino
## 70                                                 Annotation of Estimate!!Total!!Not Hispanic or Latino
## 38                                                        Margin of Error!!Total!!Not Hispanic or Latino
## 69                                          Annotation of Margin of Error!!Total!!Not Hispanic or Latino
## 35                                                  Estimate!!Total!!Not Hispanic or Latino!!White alone
## 78                                    Annotation of Estimate!!Total!!Not Hispanic or Latino!!White alone
## 36                                           Margin of Error!!Total!!Not Hispanic or Latino!!White alone
## 77                             Annotation of Margin of Error!!Total!!Not Hispanic or Latino!!White alone
## 33                              Estimate!!Total!!Not Hispanic or Latino!!Black or African American alone
## 80                Annotation of Estimate!!Total!!Not Hispanic or Latino!!Black or African American alone
## 34                       Margin of Error!!Total!!Not Hispanic or Latino!!Black or African American alone
## 79         Annotation of Margin of Error!!Total!!Not Hispanic or Latino!!Black or African American alone
## 31                      Estimate!!Total!!Not Hispanic or Latino!!American Indian and Alaska Native alone
## 82        Annotation of Estimate!!Total!!Not Hispanic or Latino!!American Indian and Alaska Native alone
## 32               Margin of Error!!Total!!Not Hispanic or Latino!!American Indian and Alaska Native alone
## 81 Annotation of Margin of Error!!Total!!Not Hispanic or Latino!!American Indian and Alaska Native alone
##    predicateType  group limit predicateOnly                           concept
## 29           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 67        string B03002     0          TRUE                              &lt;NA&gt;
## 30           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 68        string B03002     0          TRUE                              &lt;NA&gt;
## 37           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 70        string B03002     0          TRUE                              &lt;NA&gt;
## 38           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 69        string B03002     0          TRUE                              &lt;NA&gt;
## 35           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 78        string B03002     0          TRUE                              &lt;NA&gt;
## 36           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 77        string B03002     0          TRUE                              &lt;NA&gt;
## 33           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 80        string B03002     0          TRUE                              &lt;NA&gt;
## 34           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 79        string B03002     0          TRUE                              &lt;NA&gt;
## 31           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 82        string B03002     0          TRUE                              &lt;NA&gt;
## 32           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 81        string B03002     0          TRUE                              &lt;NA&gt;</code></pre>
<p>Okay we’re on the right track but it would be nice to see this list without the margin of errors and annotation variables. How can we get a list of variables that end in E but not in M or EA or MA? The answer is something called regular expressions, which is a specialist term for pattern matching. This is a long topic, so we are just going to work out one type of example, which is matching strings with a specific ending. The R function for “get regular expression” is called <code>grep()</code>.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1"><span class="co"># suppose we have a list of words and we want to know which ones end in the letter &quot;e&quot;</span></a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="co"># The end of a string is denoted by $ in regular expressions, so to match &quot;e at the end&quot;</span></a>
<a class="sourceLine" id="cb142-3" data-line-number="3"><span class="co"># we look for a pattern that we write as &quot;e$&quot;</span></a>
<a class="sourceLine" id="cb142-4" data-line-number="4"><span class="co"># </span></a>
<a class="sourceLine" id="cb142-5" data-line-number="5">someFruit &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;pear&quot;</span>)</a>
<a class="sourceLine" id="cb142-6" data-line-number="6"><span class="kw">grep</span>(<span class="st">&quot;e$&quot;</span>, someFruit)</a></code></pre></div>
<pre><code>## [1] 1 2</code></pre>
<p>By default <code>grep</code> returns the indices of the matched values, not the values themselves. In this case, the first two words matched. If we want the values, we use <code>grep</code> with the <code>value=TRUE</code> option as follows</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1"><span class="kw">grep</span>(<span class="st">&quot;e$&quot;</span>, someFruit, <span class="dt">value =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] &quot;apple&quot;  &quot;orange&quot;</code></pre>
<p>You can probably guess how to modify this pattern to find the string ending in “a” instead. If you want both, that is strings ending in either “a” or “e”, this is the way to do it. By the way, the pattern matching is case-sensitive.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1"><span class="kw">grep</span>(<span class="st">&quot;(e|a)$&quot;</span>, someFruit, <span class="dt">value =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] &quot;apple&quot;  &quot;orange&quot; &quot;banana&quot;</code></pre>
<p>With this, let’s reduce the list of variables</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="kw">head</span>(group_B03002[<span class="kw">grep</span>(<span class="st">&quot;E$&quot;</span>, group_B03002<span class="op">$</span>name),])</a></code></pre></div>
<pre><code>##           name
## 25 B03002_021E
## 27 B03002_020E
## 29 B03002_001E
## 31 B03002_005E
## 33 B03002_004E
## 35 B03002_003E
##                                                                                                                   label
## 25 Estimate!!Total!!Hispanic or Latino!!Two or more races!!Two races excluding Some other race, and three or more races
## 27                          Estimate!!Total!!Hispanic or Latino!!Two or more races!!Two races including Some other race
## 29                                                                                                      Estimate!!Total
## 31                                     Estimate!!Total!!Not Hispanic or Latino!!American Indian and Alaska Native alone
## 33                                             Estimate!!Total!!Not Hispanic or Latino!!Black or African American alone
## 35                                                                 Estimate!!Total!!Not Hispanic or Latino!!White alone
##    predicateType  group limit predicateOnly                           concept
## 25           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 27           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 29           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 31           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 33           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 35           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE</code></pre>
<p>With this easier to parse table, we can select the variables we want in particular:</p>
<ul>
<li>B03002_001E Estimate!!Total<br />
</li>
<li>B03002_002E Estimate!!Total!!Not Hispanic or Latino</li>
<li>B03002_003E Estimate!!Total!!Not Hispanic or Latino!!White alone</li>
<li>B03002_004E Estimate!!Total!!Not Hispanic or Latino!!Black or African American alone</li>
<li>B03002_006E Estimate!!Total!!Not Hispanic or Latino!!Asian alone</li>
<li>B03002_012E Estimate!!Total!!Hispanic or Latino</li>
</ul>
<p>We’ll use the first two for normalizing proportions and for determining the non-Hispanic “Other” category. To get race by borough,</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1">race_boro &lt;-<span class="st"> </span><span class="kw">getCensus</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb150-2" data-line-number="2">                       <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb150-3" data-line-number="3">                       <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;NAME&quot;</span>, <span class="st">&quot;B03002_001E&quot;</span>,</a>
<a class="sourceLine" id="cb150-4" data-line-number="4">                                <span class="st">&quot;B03002_002E&quot;</span>,<span class="st">&quot;B03002_003E&quot;</span>,<span class="st">&quot;B03002_004E&quot;</span>, </a>
<a class="sourceLine" id="cb150-5" data-line-number="5">                                <span class="st">&quot;B03002_006E&quot;</span>, <span class="st">&quot;B03002_012E&quot;</span>  </a>
<a class="sourceLine" id="cb150-6" data-line-number="6">                                 ),</a>
<a class="sourceLine" id="cb150-7" data-line-number="7">                       <span class="dt">region =</span> <span class="st">&quot;county:005,047,061,081,085&quot;</span>,</a>
<a class="sourceLine" id="cb150-8" data-line-number="8">                       <span class="dt">regionin =</span> <span class="st">&quot;state:36&quot;</span>, </a>
<a class="sourceLine" id="cb150-9" data-line-number="9">                       <span class="dt">key =</span> myKey</a>
<a class="sourceLine" id="cb150-10" data-line-number="10">                       )</a>
<a class="sourceLine" id="cb150-11" data-line-number="11"></a>
<a class="sourceLine" id="cb150-12" data-line-number="12"><span class="co"># give variable names</span></a>
<a class="sourceLine" id="cb150-13" data-line-number="13"><span class="co"># </span></a>
<a class="sourceLine" id="cb150-14" data-line-number="14"><span class="kw">names</span>(race_boro)[<span class="kw">which</span>(<span class="kw">names</span>(race_boro)<span class="op">==</span><span class="st">&quot;B03002_001E&quot;</span>)] &lt;-<span class="st"> &quot;Total_HispRace&quot;</span></a>
<a class="sourceLine" id="cb150-15" data-line-number="15"><span class="kw">names</span>(race_boro)[<span class="kw">which</span>(<span class="kw">names</span>(race_boro)<span class="op">==</span><span class="st">&quot;B03002_002E&quot;</span>)] &lt;-<span class="st"> &quot;NH_Total&quot;</span></a>
<a class="sourceLine" id="cb150-16" data-line-number="16"><span class="kw">names</span>(race_boro)[<span class="kw">which</span>(<span class="kw">names</span>(race_boro)<span class="op">==</span><span class="st">&quot;B03002_003E&quot;</span>)] &lt;-<span class="st"> &quot;NH_White&quot;</span></a>
<a class="sourceLine" id="cb150-17" data-line-number="17"><span class="kw">names</span>(race_boro)[<span class="kw">which</span>(<span class="kw">names</span>(race_boro)<span class="op">==</span><span class="st">&quot;B03002_004E&quot;</span>)] &lt;-<span class="st"> &quot;NH_Black&quot;</span></a>
<a class="sourceLine" id="cb150-18" data-line-number="18"><span class="kw">names</span>(race_boro)[<span class="kw">which</span>(<span class="kw">names</span>(race_boro)<span class="op">==</span><span class="st">&quot;B03002_006E&quot;</span>)] &lt;-<span class="st"> &quot;NH_Asian&quot;</span></a>
<a class="sourceLine" id="cb150-19" data-line-number="19"><span class="kw">names</span>(race_boro)[<span class="kw">which</span>(<span class="kw">names</span>(race_boro)<span class="op">==</span><span class="st">&quot;B03002_012E&quot;</span>)] &lt;-<span class="st"> &quot;Hisp_Latin&quot;</span></a>
<a class="sourceLine" id="cb150-20" data-line-number="20"></a>
<a class="sourceLine" id="cb150-21" data-line-number="21"><span class="co"># create the non-Hispanic Other category</span></a>
<a class="sourceLine" id="cb150-22" data-line-number="22">race_boro &lt;-<span class="st"> </span>race_boro <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">NH_Other =</span> NH_Total<span class="op">-</span>NH_Black<span class="op">-</span>NH_White<span class="op">-</span>NH_Asian) </a>
<a class="sourceLine" id="cb150-23" data-line-number="23"></a>
<a class="sourceLine" id="cb150-24" data-line-number="24"><span class="co"># convert to proportions by dividing by total</span></a>
<a class="sourceLine" id="cb150-25" data-line-number="25"><span class="co"># note use of new data frame, so totals are still stored in race_boro</span></a>
<a class="sourceLine" id="cb150-26" data-line-number="26">race_boro_proportion &lt;-<span class="st"> </span>race_boro  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">transmute</span>(<span class="dt">Hisp_Latin =</span> Hisp_Latin<span class="op">/</span>Total_HispRace, </a>
<a class="sourceLine" id="cb150-27" data-line-number="27">                                                 <span class="dt">NH_Black =</span> NH_Black<span class="op">/</span>Total_HispRace,</a>
<a class="sourceLine" id="cb150-28" data-line-number="28">                                                 <span class="dt">NH_White=</span>NH_White<span class="op">/</span>Total_HispRace,</a>
<a class="sourceLine" id="cb150-29" data-line-number="29">                                                 <span class="dt">NH_Asian=</span>NH_Asian<span class="op">/</span>Total_HispRace,</a>
<a class="sourceLine" id="cb150-30" data-line-number="30">                                                 <span class="dt">NH_Other=</span>NH_Other<span class="op">/</span>Total_HispRace) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb150-31" data-line-number="31"><span class="st">                                      </span><span class="kw">round</span>(., <span class="dt">digits=</span><span class="dv">3</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb150-32" data-line-number="32"></a>
<a class="sourceLine" id="cb150-33" data-line-number="33">race_boro_proportion<span class="op">$</span>Borough &lt;-<span class="st"> </span>getBoro[race_boro<span class="op">$</span>NAME]</a>
<a class="sourceLine" id="cb150-34" data-line-number="34">race_boro_proportion </a></code></pre></div>
<pre><code>##   Hisp_Latin NH_Black NH_White NH_Asian NH_Other       Borough
## 1       28.0     17.2     25.3     25.1      4.4        Queens
## 2       19.2     30.3     36.2     11.7      2.6      Brooklyn
## 3       26.0     12.5     46.9     11.9      2.8     Manhattan
## 4       18.3      9.3     61.7      8.6      2.1 Staten Island
## 5       55.9     29.3      9.3      3.5      2.0     The Bronx</code></pre>
</div>
</div>
<p style="text-align: center;">
<a href="15-2-part2.html"><button class="btn btn-default">Previous</button></a>
<a href="15-4-zipcode.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
