<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Part 3: More (and messier) Census data | Carpe Datum</title>
  <meta name="description" content="Chapter 16 Part 3: More (and messier) Census data | Carpe Datum" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Part 3: More (and messier) Census data | Carpe Datum" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Part 3: More (and messier) Census data | Carpe Datum" />
  
  
  

<meta name="author" content="Yoav Bergner" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="nyc-covid-19-data.html"/>
<link rel="next" href="sec-randomness.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Carpe Datum: Data Science for Life's Big Questions</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caveat"><i class="fa fa-check"></i>Caveat</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#guiding-principles-in-this-book"><i class="fa fa-check"></i>Guiding principles in this book</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#question-driven"><i class="fa fa-check"></i>Question-driven</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#no-proofs"><i class="fa fa-check"></i>No proofs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-many-kinds-of-people-are-there.html"><a href="how-many-kinds-of-people-are-there.html"><i class="fa fa-check"></i>How Many Kinds of People Are There?</a><ul>
<li class="chapter" data-level="" data-path="how-many-kinds-of-people-are-there.html"><a href="how-many-kinds-of-people-are-there.html#things-are-about-to-get-meta-right-from-the-start"><i class="fa fa-check"></i>Things are about to get meta right from the start</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="categories.html"><a href="categories.html"><i class="fa fa-check"></i><b>1</b> Categories, counts, and kinds</a><ul>
<li class="chapter" data-level="" data-path="categories.html"><a href="categories.html#two-kinds-of-people"><i class="fa fa-check"></i>Two Kinds of People</a></li>
<li class="chapter" data-level="" data-path="categories.html"><a href="categories.html#samples-and-populations-a-statistical-caveat"><i class="fa fa-check"></i>Samples and Populations: A Statistical Caveat</a></li>
<li class="chapter" data-level="" data-path="categories.html"><a href="categories.html#a-psychological-caveat"><i class="fa fa-check"></i>A Psychological Caveat</a></li>
<li class="chapter" data-level="" data-path="categories.html"><a href="categories.html#summarizing-data"><i class="fa fa-check"></i>Summarizing data</a></li>
<li class="chapter" data-level="" data-path="categories.html"><a href="categories.html#checkpoint"><i class="fa fa-check"></i>Checkpoint</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="dimensions.html"><a href="dimensions.html"><i class="fa fa-check"></i><b>2</b> Dimensions</a><ul>
<li class="chapter" data-level="" data-path="dimensions.html"><a href="dimensions.html#independence-association-and-contingency"><i class="fa fa-check"></i>Independence, Association, and Contingency</a></li>
<li class="chapter" data-level="" data-path="dimensions.html"><a href="dimensions.html#latent-factors-and-measurement"><i class="fa fa-check"></i>Latent Factors and Measurement</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="test-indep.html"><a href="test-indep.html"><i class="fa fa-check"></i><b>3</b> Tests of independence: A first look starring alternate universes</a><ul>
<li class="chapter" data-level="" data-path="test-indep.html"><a href="test-indep.html#rise-of-the-machines"><i class="fa fa-check"></i>Rise of the machines</a></li>
<li class="chapter" data-level="" data-path="test-indep.html"><a href="test-indep.html#hypothesis-testing-just-happened"><i class="fa fa-check"></i>Hypothesis testing just happened</a></li>
<li class="chapter" data-level="" data-path="test-indep.html"><a href="test-indep.html#caveats"><i class="fa fa-check"></i>Caveats</a></li>
<li class="chapter" data-level="" data-path="test-indep.html"><a href="test-indep.html#sampling-simulations-and-randomness"><i class="fa fa-check"></i>Sampling, simulations, and randomness</a><ul>
<li class="chapter" data-level="" data-path="test-indep.html"><a href="test-indep.html#tossing-virtual-coins"><i class="fa fa-check"></i>Tossing (virtual) coins</a></li>
<li><a href="test-indep.html#but-some-observations-do-occur-more-than-others">But some observations <em>do</em> occur more than others</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="shades.html"><a href="shades.html"><i class="fa fa-check"></i><b>4</b> (An Infinite Number of) Shades of Gray (or Brown)</a><ul>
<li class="chapter" data-level="" data-path="shades.html"><a href="shades.html#poopiness"><i class="fa fa-check"></i>Poopiness</a><ul>
<li class="chapter" data-level="" data-path="shades.html"><a href="shades.html#mixtures"><i class="fa fa-check"></i>Mixtures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="shades.html"><a href="shades.html#crappiness"><i class="fa fa-check"></i>Crappiness</a><ul>
<li class="chapter" data-level="" data-path="shades.html"><a href="shades.html#check-your-understanding"><i class="fa fa-check"></i>Check your understanding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cut-scores-and-abnormality.html"><a href="cut-scores-and-abnormality.html"><i class="fa fa-check"></i><b>5</b> Cut Scores and Abnormality</a></li>
<li class="chapter" data-level="6" data-path="the-modal-american.html"><a href="the-modal-american.html"><i class="fa fa-check"></i><b>6</b> The Modal American</a><ul>
<li class="chapter" data-level="" data-path="the-modal-american.html"><a href="the-modal-american.html#step-one-categories"><i class="fa fa-check"></i>Step one: categories</a></li>
<li class="chapter" data-level="" data-path="the-modal-american.html"><a href="the-modal-american.html#step-two-contingency-table"><i class="fa fa-check"></i>Step two: contingency table</a></li>
<li class="chapter" data-level="" data-path="the-modal-american.html"><a href="the-modal-american.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sixteen-personalities-or-five-factors.html"><a href="sixteen-personalities-or-five-factors.html"><i class="fa fa-check"></i><b>7</b> Sixteen Personalities or Five Factors?</a><ul>
<li class="chapter" data-level="" data-path="sixteen-personalities-or-five-factors.html"><a href="sixteen-personalities-or-five-factors.html#mbti"><i class="fa fa-check"></i>MBTI</a></li>
<li class="chapter" data-level="" data-path="sixteen-personalities-or-five-factors.html"><a href="sixteen-personalities-or-five-factors.html#big-five"><i class="fa fa-check"></i>Big Five</a></li>
<li class="chapter" data-level="" data-path="sixteen-personalities-or-five-factors.html"><a href="sixteen-personalities-or-five-factors.html#twenty-questions-about-extraversion"><i class="fa fa-check"></i>Twenty Questions (about Extraversion)</a></li>
<li class="chapter" data-level="" data-path="sixteen-personalities-or-five-factors.html"><a href="sixteen-personalities-or-five-factors.html#but-whats-the-point"><i class="fa fa-check"></i>But what’s the point?</a></li>
<li class="chapter" data-level="" data-path="sixteen-personalities-or-five-factors.html"><a href="sixteen-personalities-or-five-factors.html#still-meta-after-all-these-pages"><i class="fa fa-check"></i>Still meta after all these pages</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="when-and-how-will-you-die.html"><a href="when-and-how-will-you-die.html"><i class="fa fa-check"></i><b>8</b> When and How Will You Die?</a><ul>
<li class="chapter" data-level="" data-path="when-and-how-will-you-die.html"><a href="when-and-how-will-you-die.html#not-quite-death-but-um-rain"><i class="fa fa-check"></i>Not Quite Death, but, um… Rain?</a><ul>
<li class="chapter" data-level="" data-path="when-and-how-will-you-die.html"><a href="when-and-how-will-you-die.html#stochastic-vs-deterministic-relationships"><i class="fa fa-check"></i>Stochastic vs Deterministic relationships</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="when-and-how-will-you-die.html"><a href="when-and-how-will-you-die.html#ways-of-thinking-about-probabilistic-statements"><i class="fa fa-check"></i>Ways of thinking about probabilistic statements</a><ul>
<li class="chapter" data-level="" data-path="when-and-how-will-you-die.html"><a href="when-and-how-will-you-die.html#ensembles"><i class="fa fa-check"></i>Ensembles</a></li>
<li class="chapter" data-level="" data-path="when-and-how-will-you-die.html"><a href="when-and-how-will-you-die.html#degree-of-belief"><i class="fa fa-check"></i>Degree of belief</a></li>
<li class="chapter" data-level="" data-path="when-and-how-will-you-die.html"><a href="when-and-how-will-you-die.html#decisions"><i class="fa fa-check"></i>Decisions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="when-and-how-will-you-die.html"><a href="when-and-how-will-you-die.html#death"><i class="fa fa-check"></i>Death</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="conditional-death.html"><a href="conditional-death.html"><i class="fa fa-check"></i><b>9</b> Conditional Death</a><ul>
<li class="chapter" data-level="" data-path="conditional-death.html"><a href="conditional-death.html#how-does-the-death-simulation-work"><i class="fa fa-check"></i>How does the death (simulation) work?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="somefacts.html"><a href="somefacts.html"><i class="fa fa-check"></i><b>10</b> Some facts about Probabilities</a><ul>
<li class="chapter" data-level="" data-path="somefacts.html"><a href="somefacts.html#conditional-probabilities"><i class="fa fa-check"></i>Conditional Probabilities</a></li>
<li class="chapter" data-level="" data-path="somefacts.html"><a href="somefacts.html#conditional-death-again"><i class="fa fa-check"></i>Conditional death, again</a><ul>
<li class="chapter" data-level="" data-path="somefacts.html"><a href="somefacts.html#just-to-make-things-weird"><i class="fa fa-check"></i>Just to make things weird</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="how-you-will-die-causes-or-conditions.html"><a href="how-you-will-die-causes-or-conditions.html"><i class="fa fa-check"></i><b>11</b> How You Will Die: Causes or Conditions?</a><ul>
<li class="chapter" data-level="" data-path="how-you-will-die-causes-or-conditions.html"><a href="how-you-will-die-causes-or-conditions.html#causes-of-death-colloquially"><i class="fa fa-check"></i>Causes of death, colloquially</a></li>
<li class="chapter" data-level="" data-path="how-you-will-die-causes-or-conditions.html"><a href="how-you-will-die-causes-or-conditions.html#hold-my-beer"><i class="fa fa-check"></i>Hold my beer</a></li>
<li class="chapter" data-level="" data-path="how-you-will-die-causes-or-conditions.html"><a href="how-you-will-die-causes-or-conditions.html#non-deterministic-causation"><i class="fa fa-check"></i>Non-deterministic Causation</a></li>
<li class="chapter" data-level="" data-path="how-you-will-die-causes-or-conditions.html"><a href="how-you-will-die-causes-or-conditions.html#testing-for-an-association-between-two-variables"><i class="fa fa-check"></i>Testing for an association between two variables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="will-you-make-money.html"><a href="will-you-make-money.html"><i class="fa fa-check"></i>Will You Make Money?</a><ul>
<li class="chapter" data-level="" data-path="will-you-make-money.html"><a href="will-you-make-money.html#battle-of-the-bills"><i class="fa fa-check"></i>Battle of the Bills</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="betting-on-beer-or-ice-cream.html"><a href="betting-on-beer-or-ice-cream.html"><i class="fa fa-check"></i><b>12</b> Betting on Beer (or Ice Cream)</a><ul>
<li class="chapter" data-level="" data-path="betting-on-beer-or-ice-cream.html"><a href="betting-on-beer-or-ice-cream.html#how-do-statisticians-solve-problems-like-this"><i class="fa fa-check"></i>How do statisticians solve problems like this?</a><ul>
<li class="chapter" data-level="" data-path="betting-on-beer-or-ice-cream.html"><a href="betting-on-beer-or-ice-cream.html#the-solution-by-counting-or-combinatorics"><i class="fa fa-check"></i>The solution by counting, or combinatorics</a></li>
<li class="chapter" data-level="" data-path="betting-on-beer-or-ice-cream.html"><a href="betting-on-beer-or-ice-cream.html#the-solution-by-distribution-or-statistics"><i class="fa fa-check"></i>The solution by distribution, or statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="expected-value.html"><a href="expected-value.html"><i class="fa fa-check"></i><b>13</b> Expected Value</a><ul>
<li class="chapter" data-level="" data-path="expected-value.html"><a href="expected-value.html#betting-on-ice-cream"><i class="fa fa-check"></i>Betting on ice cream</a><ul>
<li class="chapter" data-level="" data-path="expected-value.html"><a href="expected-value.html#by-the-statistical-power-of-grayskull"><i class="fa fa-check"></i>By the (Statistical) Power of Grayskull</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="expected-value.html"><a href="expected-value.html#betting-on-your-future"><i class="fa fa-check"></i>Betting on your Future</a><ul>
<li class="chapter" data-level="" data-path="expected-value.html"><a href="expected-value.html#why-why-why-multiply-ay-ay"><i class="fa fa-check"></i>Why why why multiply-ay-ay?</a></li>
<li class="chapter" data-level="" data-path="expected-value.html"><a href="expected-value.html#where-do-branching-probabilities-come-from"><i class="fa fa-check"></i>Where do branching probabilities come from?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="is-the-system-fair.html"><a href="is-the-system-fair.html"><i class="fa fa-check"></i>Is the System Fair?</a></li>
<li class="chapter" data-level="14" data-path="differences-in-athletics.html"><a href="differences-in-athletics.html"><i class="fa fa-check"></i><b>14</b> Differences in athletics</a><ul>
<li class="chapter" data-level="" data-path="differences-in-athletics.html"><a href="differences-in-athletics.html#are-professional-basketball-players-taller"><i class="fa fa-check"></i>Are professional basketball players taller?</a><ul>
<li class="chapter" data-level="" data-path="differences-in-athletics.html"><a href="differences-in-athletics.html#none-of-this-is-surprising"><i class="fa fa-check"></i>None of this is surprising</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="differences-in-athletics.html"><a href="differences-in-athletics.html#surprising-differences"><i class="fa fa-check"></i>Surprising differences</a></li>
<li class="chapter" data-level="" data-path="differences-in-athletics.html"><a href="differences-in-athletics.html#fairness-on-trial-trans-athletes"><i class="fa fa-check"></i>Fairness on trial: trans athletes</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="nyc-covid-19-data.html"><a href="nyc-covid-19-data.html"><i class="fa fa-check"></i><b>15</b> NYC COVID-19 Data</a><ul>
<li class="chapter" data-level="" data-path="nyc-covid-19-data.html"><a href="nyc-covid-19-data.html#prologue"><i class="fa fa-check"></i>Prologue</a></li>
<li class="chapter" data-level="15.1" data-path="nyc-covid-19-data.html"><a href="nyc-covid-19-data.html#part-1-covid-nyc"><i class="fa fa-check"></i><b>15.1</b> Part 1: COVID NYC</a><ul>
<li class="chapter" data-level="" data-path="nyc-covid-19-data.html"><a href="nyc-covid-19-data.html#getting-some-data"><i class="fa fa-check"></i>Getting some data</a></li>
<li class="chapter" data-level="" data-path="nyc-covid-19-data.html"><a href="nyc-covid-19-data.html#local-data-on-covid-from-the-city-andor-state"><i class="fa fa-check"></i>Local data on COVID from the city and/or state</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="nyc-covid-19-data.html"><a href="nyc-covid-19-data.html#part-2-getting-started-with-us-census-data"><i class="fa fa-check"></i><b>15.2</b> Part 2: Getting started with US Census data</a><ul>
<li class="chapter" data-level="" data-path="nyc-covid-19-data.html"><a href="nyc-covid-19-data.html#census-variables"><i class="fa fa-check"></i>Census Variables</a></li>
<li class="chapter" data-level="" data-path="nyc-covid-19-data.html"><a href="nyc-covid-19-data.html#geography-units"><i class="fa fa-check"></i>Geography Units</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="part-3-more-and-messier-census-data.html"><a href="part-3-more-and-messier-census-data.html"><i class="fa fa-check"></i><b>16</b> Part 3: More (and messier) Census data</a><ul>
<li class="chapter" data-level="" data-path="part-3-more-and-messier-census-data.html"><a href="part-3-more-and-messier-census-data.html#exploring-the-acs-data"><i class="fa fa-check"></i>Exploring the ACS data</a><ul>
<li class="chapter" data-level="16.0.1" data-path="part-3-more-and-messier-census-data.html"><a href="part-3-more-and-messier-census-data.html#zip-code-level-median-income"><i class="fa fa-check"></i><b>16.0.1</b> Zip-code-level median income</a></li>
<li class="chapter" data-level="16.0.2" data-path="part-3-more-and-messier-census-data.html"><a href="part-3-more-and-messier-census-data.html#zip-code-level-race"><i class="fa fa-check"></i><b>16.0.2</b> Zip-code-level race</a></li>
<li class="chapter" data-level="16.0.3" data-path="part-3-more-and-messier-census-data.html"><a href="part-3-more-and-messier-census-data.html#some-more-variables-to-play-with"><i class="fa fa-check"></i><b>16.0.3</b> Some more variables to play with</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="sec-randomness.html"><a href="sec-randomness.html"><i class="fa fa-check"></i><b>A</b> Randomness</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Carpe Datum</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="part-3-more-and-messier-census-data" class="section level1">
<h1><span class="header-section-number">Chapter 16</span> Part 3: More (and messier) Census data</h1>
<div id="exploring-the-acs-data" class="section level2 unnumbered">
<h2>Exploring the ACS data</h2>
<p>So far, we have been selecting one or two variables at a time, because we knew what we were looking for. Sometimes, though, you’re not exactly sure what variables are in the data. Moreoever, since many of the ACS tables combine categories (such as SEX BY AGE), the number of variables grows exponentially (e.g., as the number of SEX categories times the number of AGE categories). Add to that the margin-of-error and annotation variables, and the list gets overwhelming fast.</p>
<p>Even data from the SEX BY AGE group (B01001), which seems simple, is rather complicated-looking! I will walk through it deliberately, as I would do if I were exploring the data for the first time and not sure what I was going to find.</p>
<p>First, I will use the function <code>listCensusMetadata</code> to request all of the variables in the group B01001 and see what we see.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1"><span class="co"># a list of groups can be found here; there are 1135 of them!</span></a>
<a class="sourceLine" id="cb129-2" data-line-number="2"><span class="co"># acs_groups &lt;- listCensusMetadata(name = &quot;acs/acs5&quot;, vintage = 2018, type = &quot;groups&quot;)</span></a>
<a class="sourceLine" id="cb129-3" data-line-number="3"><span class="co"># head(acs_groups)</span></a>
<a class="sourceLine" id="cb129-4" data-line-number="4"></a>
<a class="sourceLine" id="cb129-5" data-line-number="5"><span class="co"># here are the variables in the SEX BY AGE group</span></a>
<a class="sourceLine" id="cb129-6" data-line-number="6">group_B01001 &lt;-<span class="st"> </span><span class="kw">listCensusMetadata</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb129-7" data-line-number="7">                                   <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb129-8" data-line-number="8">                                   <span class="dt">type =</span> <span class="st">&quot;variables&quot;</span>,</a>
<a class="sourceLine" id="cb129-9" data-line-number="9">                                   <span class="dt">group =</span> <span class="st">&quot;B01001&quot;</span>)</a>
<a class="sourceLine" id="cb129-10" data-line-number="10"><span class="kw">head</span>(group_B01001[<span class="kw">order</span>(group_B01001<span class="op">$</span>name),], <span class="dv">20</span>)</a></code></pre></div>
<pre><code>##             name                                                      label
## 139  B01001_001E                                            Estimate!!Total
## 41  B01001_001EA                              Annotation of Estimate!!Total
## 140  B01001_001M                                     Margin of Error!!Total
## 42  B01001_001MA                       Annotation of Margin of Error!!Total
## 137  B01001_002E                                      Estimate!!Total!!Male
## 53  B01001_002EA                        Annotation of Estimate!!Total!!Male
## 138  B01001_002M                               Margin of Error!!Total!!Male
## 54  B01001_002MA                 Annotation of Margin of Error!!Total!!Male
## 143  B01001_003E                       Estimate!!Total!!Male!!Under 5 years
## 50  B01001_003EA         Annotation of Estimate!!Total!!Male!!Under 5 years
## 144  B01001_003M                Margin of Error!!Total!!Male!!Under 5 years
## 51  B01001_003MA  Annotation of Margin of Error!!Total!!Male!!Under 5 years
## 141  B01001_004E                        Estimate!!Total!!Male!!5 to 9 years
## 52  B01001_004EA          Annotation of Estimate!!Total!!Male!!5 to 9 years
## 142  B01001_004M                 Margin of Error!!Total!!Male!!5 to 9 years
## 57  B01001_004MA   Annotation of Margin of Error!!Total!!Male!!5 to 9 years
## 148  B01001_005E                      Estimate!!Total!!Male!!10 to 14 years
## 58  B01001_005EA        Annotation of Estimate!!Total!!Male!!10 to 14 years
## 149  B01001_005M               Margin of Error!!Total!!Male!!10 to 14 years
## 55  B01001_005MA Annotation of Margin of Error!!Total!!Male!!10 to 14 years
##     predicateType  group limit predicateOnly    concept
## 139           int B01001     0          TRUE SEX BY AGE
## 41         string B01001     0          TRUE       &lt;NA&gt;
## 140           int B01001     0          TRUE SEX BY AGE
## 42         string B01001     0          TRUE       &lt;NA&gt;
## 137           int B01001     0          TRUE SEX BY AGE
## 53         string B01001     0          TRUE       &lt;NA&gt;
## 138           int B01001     0          TRUE SEX BY AGE
## 54         string B01001     0          TRUE       &lt;NA&gt;
## 143           int B01001     0          TRUE SEX BY AGE
## 50         string B01001     0          TRUE       &lt;NA&gt;
## 144           int B01001     0          TRUE SEX BY AGE
## 51         string B01001     0          TRUE       &lt;NA&gt;
## 141           int B01001     0          TRUE SEX BY AGE
## 52         string B01001     0          TRUE       &lt;NA&gt;
## 142           int B01001     0          TRUE SEX BY AGE
## 57         string B01001     0          TRUE       &lt;NA&gt;
## 148           int B01001     0          TRUE SEX BY AGE
## 58         string B01001     0          TRUE       &lt;NA&gt;
## 149           int B01001     0          TRUE SEX BY AGE
## 55         string B01001     0          TRUE       &lt;NA&gt;</code></pre>
<p>Note that our table of variables here includes variable name, lable, andtype. For type, we have “int” for integers (numbers) and “string” which is the computational shorthand for “string of characters.” This is the variable-type used for words and sentences as well as passwords or other random strings of characters.</p>
<p>To make the results more readable, we can try identify the pattern in the order of the variables. First, let’s observe the following. The numbers after the group name are just increasing from 001, 002, and so on. We might want to look at the middle of this list, e.g, from 020 to 050, which we can do as follows:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1">myVars &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;B01001_0&quot;</span>,<span class="kw">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="dv">20</span><span class="op">:</span><span class="dv">50</span>), <span class="st">&quot;E&quot;</span>)</a>
<a class="sourceLine" id="cb131-2" data-line-number="2">group_B01001 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(name <span class="op">%in%</span><span class="st"> </span>myVars) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)</a></code></pre></div>
<pre><code>##           name                                      label predicateType  group
## 1  B01001_020E     Estimate!!Total!!Male!!65 and 66 years           int B01001
## 2  B01001_021E      Estimate!!Total!!Male!!67 to 69 years           int B01001
## 3  B01001_022E      Estimate!!Total!!Male!!70 to 74 years           int B01001
## 4  B01001_023E      Estimate!!Total!!Male!!75 to 79 years           int B01001
## 5  B01001_024E      Estimate!!Total!!Male!!80 to 84 years           int B01001
## 6  B01001_025E   Estimate!!Total!!Male!!85 years and over           int B01001
## 7  B01001_026E                    Estimate!!Total!!Female           int B01001
## 8  B01001_027E     Estimate!!Total!!Female!!Under 5 years           int B01001
## 9  B01001_028E      Estimate!!Total!!Female!!5 to 9 years           int B01001
## 10 B01001_029E    Estimate!!Total!!Female!!10 to 14 years           int B01001
## 11 B01001_030E    Estimate!!Total!!Female!!15 to 17 years           int B01001
## 12 B01001_031E   Estimate!!Total!!Female!!18 and 19 years           int B01001
## 13 B01001_032E          Estimate!!Total!!Female!!20 years           int B01001
## 14 B01001_033E          Estimate!!Total!!Female!!21 years           int B01001
## 15 B01001_034E    Estimate!!Total!!Female!!22 to 24 years           int B01001
## 16 B01001_035E    Estimate!!Total!!Female!!25 to 29 years           int B01001
## 17 B01001_036E    Estimate!!Total!!Female!!30 to 34 years           int B01001
## 18 B01001_037E    Estimate!!Total!!Female!!35 to 39 years           int B01001
## 19 B01001_038E    Estimate!!Total!!Female!!40 to 44 years           int B01001
## 20 B01001_039E    Estimate!!Total!!Female!!45 to 49 years           int B01001
## 21 B01001_040E    Estimate!!Total!!Female!!50 to 54 years           int B01001
## 22 B01001_041E    Estimate!!Total!!Female!!55 to 59 years           int B01001
## 23 B01001_042E   Estimate!!Total!!Female!!60 and 61 years           int B01001
## 24 B01001_043E    Estimate!!Total!!Female!!62 to 64 years           int B01001
## 25 B01001_044E   Estimate!!Total!!Female!!65 and 66 years           int B01001
## 26 B01001_045E    Estimate!!Total!!Female!!67 to 69 years           int B01001
## 27 B01001_046E    Estimate!!Total!!Female!!70 to 74 years           int B01001
## 28 B01001_047E    Estimate!!Total!!Female!!75 to 79 years           int B01001
## 29 B01001_048E    Estimate!!Total!!Female!!80 to 84 years           int B01001
## 30 B01001_049E Estimate!!Total!!Female!!85 years and over           int B01001
##    limit predicateOnly    concept
## 1      0          TRUE SEX BY AGE
## 2      0          TRUE SEX BY AGE
## 3      0          TRUE SEX BY AGE
## 4      0          TRUE SEX BY AGE
## 5      0          TRUE SEX BY AGE
## 6      0          TRUE SEX BY AGE
## 7      0          TRUE SEX BY AGE
## 8      0          TRUE SEX BY AGE
## 9      0          TRUE SEX BY AGE
## 10     0          TRUE SEX BY AGE
## 11     0          TRUE SEX BY AGE
## 12     0          TRUE SEX BY AGE
## 13     0          TRUE SEX BY AGE
## 14     0          TRUE SEX BY AGE
## 15     0          TRUE SEX BY AGE
## 16     0          TRUE SEX BY AGE
## 17     0          TRUE SEX BY AGE
## 18     0          TRUE SEX BY AGE
## 19     0          TRUE SEX BY AGE
## 20     0          TRUE SEX BY AGE
## 21     0          TRUE SEX BY AGE
## 22     0          TRUE SEX BY AGE
## 23     0          TRUE SEX BY AGE
## 24     0          TRUE SEX BY AGE
## 25     0          TRUE SEX BY AGE
## 26     0          TRUE SEX BY AGE
## 27     0          TRUE SEX BY AGE
## 28     0          TRUE SEX BY AGE
## 29     0          TRUE SEX BY AGE
## 30     0          TRUE SEX BY AGE</code></pre>
<p>We’ve learned the following. The variable names (after the total) begin with males. First all males, then males by increasing age group. The females. Although it looks like it from this sample, the age groups are not all in intervals of 5 years. There are groups of three, two, and even one (e.g., 15-17, 18-19, 20 years). I’m not sure why.</p>
<p>Suppose we wanted to extract the percentage of the population over the age of 65. From this table we would need to do the following</p>
<ul>
<li>add up the counts of males in each of the intervals over 65</li>
<li>B01001_020E + B01001_021E + B01001_022E + B01001_023E + B01001_024E + B01001_025E</li>
<li>add to this the counts of females in the same age intervals
<ul>
<li>B01001_044E + B01001_045E + B01001_046E + B01001_047E + B01001_048E + B01001_049E</li>
</ul></li>
<li>divide by the total
<ul>
<li>B01001_001E</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1">maleOver65Vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;B01001_020E&quot;</span>,<span class="st">&quot;B01001_021E&quot;</span>,<span class="st">&quot;B01001_022E&quot;</span>,<span class="st">&quot;B01001_023E&quot;</span>,</a>
<a class="sourceLine" id="cb133-2" data-line-number="2">                    <span class="st">&quot;B01001_024E&quot;</span>,<span class="st">&quot;B01001_025E&quot;</span>)</a>
<a class="sourceLine" id="cb133-3" data-line-number="3">femaleOver65Vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;B01001_044E&quot;</span>,<span class="st">&quot;B01001_045E&quot;</span>,<span class="st">&quot;B01001_046E&quot;</span>,<span class="st">&quot;B01001_047E&quot;</span>,</a>
<a class="sourceLine" id="cb133-4" data-line-number="4">                      <span class="st">&quot;B01001_048E&quot;</span>,<span class="st">&quot;B01001_049E&quot;</span>)</a>
<a class="sourceLine" id="cb133-5" data-line-number="5">totalPopVar &lt;-<span class="st"> &quot;B01001_001E&quot;</span></a>
<a class="sourceLine" id="cb133-6" data-line-number="6">acs_boro_over65 &lt;-<span class="st"> </span><span class="kw">getCensus</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb133-7" data-line-number="7">                           <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb133-8" data-line-number="8">                           <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;NAME&quot;</span>, maleOver65Vars,femaleOver65Vars, totalPopVar),</a>
<a class="sourceLine" id="cb133-9" data-line-number="9">                           <span class="dt">region =</span> <span class="st">&quot;county:005,047,061,081,085&quot;</span>,</a>
<a class="sourceLine" id="cb133-10" data-line-number="10">                           <span class="dt">regionin =</span> <span class="st">&quot;state:36&quot;</span>, <span class="dt">key =</span> myKey</a>
<a class="sourceLine" id="cb133-11" data-line-number="11">                         )</a>
<a class="sourceLine" id="cb133-12" data-line-number="12"></a>
<a class="sourceLine" id="cb133-13" data-line-number="13">proportionOver65 &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">rowSums</span>(acs_boro_over65[,<span class="dv">4</span><span class="op">:</span><span class="dv">15</span>])<span class="op">/</span>acs_boro_over65[,<span class="dv">16</span>],<span class="dv">3</span>)<span class="op">*</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb133-14" data-line-number="14">boro_over65_proportions &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Borough=</span>boroNames, <span class="dt">over65=</span>proportionOver65)</a>
<a class="sourceLine" id="cb133-15" data-line-number="15">boro_over65_proportions</a></code></pre></div>
<pre><code>##         Borough over65
## 1     The Bronx   14.8
## 2      Brooklyn   13.2
## 3     Manhattan   15.8
## 4        Queens   15.5
## 5 Staten Island   12.1</code></pre>
<p>If all of that seems not worth the effort, you might want to just extact something like median age per geographic unit. These are variables in the SEX BY AGE group.</p>
<ul>
<li>B01002_001E Estimate!!Median age –!!Total</li>
<li>B01002_002E Estimate!!Median age –!!Male</li>
<li>B01002_003E Estimate!!Median age –!!Female</li>
</ul>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1">medianSexByAge_boro &lt;-<span class="st"> </span><span class="kw">getCensus</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb135-2" data-line-number="2">                                 <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb135-3" data-line-number="3">                                 <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;NAME&quot;</span>, <span class="st">&quot;B01002_001E&quot;</span>, <span class="st">&quot;B01002_002E&quot;</span>, <span class="st">&quot;B01002_003E&quot;</span>),</a>
<a class="sourceLine" id="cb135-4" data-line-number="4">                                 <span class="dt">region =</span> <span class="st">&quot;county:005,047,061,081,085&quot;</span>,</a>
<a class="sourceLine" id="cb135-5" data-line-number="5">                                 <span class="dt">regionin =</span> <span class="st">&quot;state:36&quot;</span>, </a>
<a class="sourceLine" id="cb135-6" data-line-number="6">                                 <span class="dt">key =</span> myKey</a>
<a class="sourceLine" id="cb135-7" data-line-number="7">                                 )</a>
<a class="sourceLine" id="cb135-8" data-line-number="8"></a>
<a class="sourceLine" id="cb135-9" data-line-number="9"><span class="kw">names</span>(medianSexByAge_boro)[<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;medianAge&quot;</span>, <span class="st">&quot;medianAgeMale&quot;</span>,<span class="st">&quot;medianAgeFemale&quot;</span>)</a>
<a class="sourceLine" id="cb135-10" data-line-number="10">medianSexByAge_boro</a></code></pre></div>
<pre><code>##   state county                      NAME medianAge medianAgeMale
## 1    36    081   Queens County, New York      38.7          37.2
## 2    36    047    Kings County, New York      35.1          33.5
## 3    36    061 New York County, New York      37.3          36.7
## 4    36    085 Richmond County, New York      40.0          38.3
## 5    36    005    Bronx County, New York      33.9          31.7
##   medianAgeFemale
## 1            40.0
## 2            36.4
## 3            37.9
## 4            41.3
## 5            35.9</code></pre>
<p>To match the NYC race-level data we will need these categories of Race/Ethnicity</p>
<ul>
<li>All Hispanic</li>
<li>Non-Hispanic/Latino: Black,African American</li>
<li>Non-Hispanic/Latino: White</li>
<li>Non-Hispanic/Latino: Asian</li>
<li>Non-Hispanic/Latino: Other</li>
</ul>
<p>First we need to find the necessary race variables. The Census organizes race information in different variable groups, some of which separate out Hispanic or Latino origin (B03002) and some which do not (B02001). We will use the first one, again to match the way NYC has been reporting health data.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1">group_B03002 &lt;-<span class="st"> </span><span class="kw">listCensusMetadata</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb137-2" data-line-number="2">                                   <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb137-3" data-line-number="3">                                   <span class="dt">type =</span> <span class="st">&quot;variables&quot;</span>,</a>
<a class="sourceLine" id="cb137-4" data-line-number="4">                                   <span class="dt">group =</span> <span class="st">&quot;B03002&quot;</span>)</a>
<a class="sourceLine" id="cb137-5" data-line-number="5"><span class="kw">head</span>(group_B03002[<span class="kw">order</span>(group_B03002<span class="op">$</span>name),], <span class="dv">20</span>)</a></code></pre></div>
<pre><code>##            name
## 29  B03002_001E
## 67 B03002_001EA
## 30  B03002_001M
## 68 B03002_001MA
## 37  B03002_002E
## 70 B03002_002EA
## 38  B03002_002M
## 69 B03002_002MA
## 35  B03002_003E
## 78 B03002_003EA
## 36  B03002_003M
## 77 B03002_003MA
## 33  B03002_004E
## 80 B03002_004EA
## 34  B03002_004M
## 79 B03002_004MA
## 31  B03002_005E
## 82 B03002_005EA
## 32  B03002_005M
## 81 B03002_005MA
##                                                                                                    label
## 29                                                                                       Estimate!!Total
## 67                                                                         Annotation of Estimate!!Total
## 30                                                                                Margin of Error!!Total
## 68                                                                  Annotation of Margin of Error!!Total
## 37                                                               Estimate!!Total!!Not Hispanic or Latino
## 70                                                 Annotation of Estimate!!Total!!Not Hispanic or Latino
## 38                                                        Margin of Error!!Total!!Not Hispanic or Latino
## 69                                          Annotation of Margin of Error!!Total!!Not Hispanic or Latino
## 35                                                  Estimate!!Total!!Not Hispanic or Latino!!White alone
## 78                                    Annotation of Estimate!!Total!!Not Hispanic or Latino!!White alone
## 36                                           Margin of Error!!Total!!Not Hispanic or Latino!!White alone
## 77                             Annotation of Margin of Error!!Total!!Not Hispanic or Latino!!White alone
## 33                              Estimate!!Total!!Not Hispanic or Latino!!Black or African American alone
## 80                Annotation of Estimate!!Total!!Not Hispanic or Latino!!Black or African American alone
## 34                       Margin of Error!!Total!!Not Hispanic or Latino!!Black or African American alone
## 79         Annotation of Margin of Error!!Total!!Not Hispanic or Latino!!Black or African American alone
## 31                      Estimate!!Total!!Not Hispanic or Latino!!American Indian and Alaska Native alone
## 82        Annotation of Estimate!!Total!!Not Hispanic or Latino!!American Indian and Alaska Native alone
## 32               Margin of Error!!Total!!Not Hispanic or Latino!!American Indian and Alaska Native alone
## 81 Annotation of Margin of Error!!Total!!Not Hispanic or Latino!!American Indian and Alaska Native alone
##    predicateType  group limit predicateOnly                           concept
## 29           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 67        string B03002     0          TRUE                              &lt;NA&gt;
## 30           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 68        string B03002     0          TRUE                              &lt;NA&gt;
## 37           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 70        string B03002     0          TRUE                              &lt;NA&gt;
## 38           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 69        string B03002     0          TRUE                              &lt;NA&gt;
## 35           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 78        string B03002     0          TRUE                              &lt;NA&gt;
## 36           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 77        string B03002     0          TRUE                              &lt;NA&gt;
## 33           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 80        string B03002     0          TRUE                              &lt;NA&gt;
## 34           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 79        string B03002     0          TRUE                              &lt;NA&gt;
## 31           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 82        string B03002     0          TRUE                              &lt;NA&gt;
## 32           int B03002     0          TRUE HISPANIC OR LATINO ORIGIN BY RACE
## 81        string B03002     0          TRUE                              &lt;NA&gt;</code></pre>
<p>Okay we’re on the right track but it would be nice to see this list without the margin of errors and annotation variables. How can we get a list of variables that end in E but not in M or EA or MA? The answer is something called regular expressions, which is a specialist term for pattern matching. This is a long topic, so we are just going to work out one type of example, which is matching strings with a specific ending. The R function for “get regular expression” is called <code>grep()</code>.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" data-line-number="1"><span class="co"># suppose we have a list of words and we want to know which ones end in the letter &quot;e&quot;</span></a>
<a class="sourceLine" id="cb139-2" data-line-number="2"><span class="co"># The end of a string is denoted by $ in regular expressions, so to match &quot;e at the end&quot;</span></a>
<a class="sourceLine" id="cb139-3" data-line-number="3"><span class="co"># we look for a pattern that we write as &quot;e$&quot;</span></a>
<a class="sourceLine" id="cb139-4" data-line-number="4"><span class="co"># </span></a>
<a class="sourceLine" id="cb139-5" data-line-number="5">someFruit &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;pear&quot;</span>)</a>
<a class="sourceLine" id="cb139-6" data-line-number="6"><span class="kw">grep</span>(<span class="st">&quot;e$&quot;</span>, someFruit)</a></code></pre></div>
<pre><code>## [1] 1 2</code></pre>
<p>By default <code>grep</code> returns the indices of the matched values, not the values themselves. In this case, the first two words matched. If we want the values, we use grep as follows</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" data-line-number="1"><span class="kw">grep</span>(<span class="st">&quot;e$&quot;</span>, someFruit, <span class="dt">value =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] &quot;apple&quot;  &quot;orange&quot;</code></pre>
<p>You can probably guess how to modify this pattern to find the string ending in “a” instead. If you want both, that is strings ending in either “a” or “e”, this is the way to do it.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" data-line-number="1"><span class="kw">grep</span>(<span class="st">&quot;(e|a)$&quot;</span>, someFruit, <span class="dt">value =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] &quot;apple&quot;  &quot;orange&quot; &quot;banana&quot;</code></pre>
<p>With this, let’s reduce the list of variables</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" data-line-number="1"><span class="kw">View</span>(group_B03002[<span class="kw">grep</span>(<span class="st">&quot;E$&quot;</span>, group_B03002<span class="op">$</span>name),])</a></code></pre></div>
<p>With this easier to parse table, we can select the variables we want in particular</p>
<ul>
<li>B03002_001E Estimate!!Total<br />
</li>
<li>B03002_002E Estimate!!Total!!Not Hispanic or Latino</li>
<li>B03002_003E Estimate!!Total!!Not Hispanic or Latino!!White alone</li>
<li>B03002_004E Estimate!!Total!!Not Hispanic or Latino!!Black or African American alone</li>
<li>B03002_006E Estimate!!Total!!Not Hispanic or Latino!!Asian alone</li>
<li>B03002_012E Estimate!!Total!!Hispanic or Latino</li>
</ul>
<p>We’ll use the first two for normalizing proportions and for determining the non-Hispanic “Other” category. To get race by borough,</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1">race_boro &lt;-<span class="st"> </span><span class="kw">getCensus</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb146-2" data-line-number="2">                       <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb146-3" data-line-number="3">                       <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;NAME&quot;</span>, <span class="st">&quot;B03002_012E&quot;</span>, <span class="st">&quot;B03002_004E&quot;</span>, <span class="st">&quot;B03002_003E&quot;</span>, <span class="st">&quot;B03002_006E&quot;</span>,</a>
<a class="sourceLine" id="cb146-4" data-line-number="4">                                <span class="st">&quot;B03002_002E&quot;</span>, <span class="st">&quot;B03002_001E&quot;</span>),</a>
<a class="sourceLine" id="cb146-5" data-line-number="5">                       <span class="dt">region =</span> <span class="st">&quot;county:005,047,061,081,085&quot;</span>,</a>
<a class="sourceLine" id="cb146-6" data-line-number="6">                       <span class="dt">regionin =</span> <span class="st">&quot;state:36&quot;</span>, </a>
<a class="sourceLine" id="cb146-7" data-line-number="7">                       <span class="dt">key =</span> myKey</a>
<a class="sourceLine" id="cb146-8" data-line-number="8">                       )</a>
<a class="sourceLine" id="cb146-9" data-line-number="9"></a>
<a class="sourceLine" id="cb146-10" data-line-number="10"><span class="co"># give variable names</span></a>
<a class="sourceLine" id="cb146-11" data-line-number="11"><span class="kw">names</span>(race_boro)[<span class="dv">4</span><span class="op">:</span><span class="dv">9</span>] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Hisp&quot;</span>, <span class="st">&quot;NH_Black&quot;</span>, <span class="st">&quot;NH_White&quot;</span>, <span class="st">&quot;NH_Asian&quot;</span>, <span class="st">&quot;NH_Total&quot;</span>, <span class="st">&quot;Total&quot;</span>)</a>
<a class="sourceLine" id="cb146-12" data-line-number="12"></a>
<a class="sourceLine" id="cb146-13" data-line-number="13"><span class="co"># create the non-Hispanic Other category</span></a>
<a class="sourceLine" id="cb146-14" data-line-number="14">race_boro &lt;-<span class="st"> </span>race_boro <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">NH_Other =</span> NH_Total<span class="op">-</span>NH_Black<span class="op">-</span>NH_White<span class="op">-</span>NH_Asian) </a>
<a class="sourceLine" id="cb146-15" data-line-number="15"></a>
<a class="sourceLine" id="cb146-16" data-line-number="16"><span class="co"># convert to proportions by dividing by total</span></a>
<a class="sourceLine" id="cb146-17" data-line-number="17">race_boro_proportion &lt;-<span class="st"> </span>race_boro  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">transmute</span>(<span class="dt">Hisp =</span> Hisp<span class="op">/</span>Total, <span class="dt">NH_Black =</span> NH_Black<span class="op">/</span>Total, </a>
<a class="sourceLine" id="cb146-18" data-line-number="18">            <span class="dt">NH_White=</span>NH_White<span class="op">/</span>Total, <span class="dt">NH_Asian=</span>NH_Asian<span class="op">/</span>Total, <span class="dt">NH_Other=</span>NH_Other<span class="op">/</span>Total) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb146-19" data-line-number="19"><span class="st">            </span><span class="kw">round</span>(., <span class="dt">digits=</span><span class="dv">3</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb146-20" data-line-number="20"></a>
<a class="sourceLine" id="cb146-21" data-line-number="21">race_boro_proportion<span class="op">$</span>Borough &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Queens&quot;</span>,<span class="st">&quot;Brooklyn&quot;</span>,<span class="st">&quot;Manhattan&quot;</span>,<span class="st">&quot;Staten&quot;</span>, <span class="st">&quot;Bronx&quot;</span>)</a>
<a class="sourceLine" id="cb146-22" data-line-number="22">race_boro_proportion </a></code></pre></div>
<pre><code>##   Hisp NH_Black NH_White NH_Asian NH_Other   Borough
## 1 28.0     17.2     25.3     25.1      4.4    Queens
## 2 19.2     30.3     36.2     11.7      2.6  Brooklyn
## 3 26.0     12.5     46.9     11.9      2.8 Manhattan
## 4 18.3      9.3     61.7      8.6      2.1    Staten
## 5 55.9     29.3      9.3      3.5      2.0     Bronx</code></pre>
<div id="zip-code-tabulation-area" class="section level4">
<h4><span class="header-section-number">16.0.0.1</span> Zip-code tabulation area</h4>
<p>We’re going to want to use zipcode tract areas, and we will get our list from the nyc data</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1">nyc_zcta_covid &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/coronavirus-nyc/tests-by-zcta.csv&quot;</span>)</a>
<a class="sourceLine" id="cb148-2" data-line-number="2">nyc_zipcodes &lt;-<span class="st"> </span>nyc_zcta_covid <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(MODZCTA) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>()</a>
<a class="sourceLine" id="cb148-3" data-line-number="3"><span class="co"># for the API call, we will want all zipcodes in plain text with comma separation</span></a>
<a class="sourceLine" id="cb148-4" data-line-number="4">nyc_zipcode_string &lt;-<span class="st"> </span><span class="kw">paste</span>(nyc_zipcodes, <span class="dt">collapse=</span><span class="st">&quot;,&quot;</span>)</a></code></pre></div>
</div>
<div id="zip-code-level-median-income" class="section level3">
<h3><span class="header-section-number">16.0.1</span> Zip-code-level median income</h3>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1">zcta_income &lt;-<span class="st"> </span><span class="kw">getCensus</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb149-2" data-line-number="2">                         <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb149-3" data-line-number="3">                         <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;B19013_001E&quot;</span>),</a>
<a class="sourceLine" id="cb149-4" data-line-number="4">                         <span class="dt">region =</span> <span class="kw">paste0</span>(<span class="st">&quot;zip code tabulation area:&quot;</span>,nyc_zipcode_string),</a>
<a class="sourceLine" id="cb149-5" data-line-number="5">                         <span class="dt">key=</span>myKey</a>
<a class="sourceLine" id="cb149-6" data-line-number="6">                         )</a></code></pre></div>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1"><span class="kw">names</span>(zcta_income) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;zipcode&quot;</span>,<span class="st">&quot;median_income&quot;</span>)</a>
<a class="sourceLine" id="cb150-2" data-line-number="2"><span class="kw">View</span>(zcta_income)</a></code></pre></div>
</div>
<div id="zip-code-level-race" class="section level3">
<h3><span class="header-section-number">16.0.2</span> Zip-code-level race</h3>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1">zcta_race &lt;-<span class="st"> </span><span class="kw">getCensus</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb151-2" data-line-number="2">                       <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb151-3" data-line-number="3">                       <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;B03002_012E&quot;</span>, <span class="st">&quot;B03002_004E&quot;</span>, <span class="st">&quot;B03002_003E&quot;</span>, <span class="st">&quot;B03002_006E&quot;</span>,</a>
<a class="sourceLine" id="cb151-4" data-line-number="4">                                <span class="st">&quot;B03002_002E&quot;</span>, <span class="st">&quot;B03002_001E&quot;</span>),</a>
<a class="sourceLine" id="cb151-5" data-line-number="5">                       <span class="dt">region =</span> <span class="kw">paste0</span>(<span class="st">&quot;zip code tabulation area:&quot;</span>,nyc_zipcode_string),</a>
<a class="sourceLine" id="cb151-6" data-line-number="6">                       <span class="dt">key =</span> myKey</a>
<a class="sourceLine" id="cb151-7" data-line-number="7">                       )</a>
<a class="sourceLine" id="cb151-8" data-line-number="8"></a>
<a class="sourceLine" id="cb151-9" data-line-number="9"><span class="co"># give variable names</span></a>
<a class="sourceLine" id="cb151-10" data-line-number="10"><span class="kw">names</span>(zcta_race) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;zipcode&quot;</span>, <span class="st">&quot;Hisp&quot;</span>, <span class="st">&quot;NH_Black&quot;</span>, <span class="st">&quot;NH_White&quot;</span>, <span class="st">&quot;NH_Asian&quot;</span>, <span class="st">&quot;NH_Total&quot;</span>, <span class="st">&quot;Total&quot;</span>)</a>
<a class="sourceLine" id="cb151-11" data-line-number="11"></a>
<a class="sourceLine" id="cb151-12" data-line-number="12"><span class="co"># create the non-Hispanic Other category</span></a>
<a class="sourceLine" id="cb151-13" data-line-number="13">zcta_race &lt;-<span class="st"> </span>zcta_race <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">NH_Other =</span> NH_Total<span class="op">-</span>NH_Black<span class="op">-</span>NH_White<span class="op">-</span>NH_Asian) </a>
<a class="sourceLine" id="cb151-14" data-line-number="14"></a>
<a class="sourceLine" id="cb151-15" data-line-number="15"><span class="co"># convert to proportions by dividing by total</span></a>
<a class="sourceLine" id="cb151-16" data-line-number="16">zcta_race_proportion &lt;-<span class="st"> </span>zcta_race  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">transmute</span>(<span class="dt">Hisp =</span> Hisp<span class="op">/</span>Total, <span class="dt">NH_Black =</span> NH_Black<span class="op">/</span>Total, </a>
<a class="sourceLine" id="cb151-17" data-line-number="17">            <span class="dt">NH_White=</span>NH_White<span class="op">/</span>Total, <span class="dt">NH_Asian=</span>NH_Asian<span class="op">/</span>Total, <span class="dt">NH_Other=</span>NH_Other<span class="op">/</span>Total) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb151-18" data-line-number="18"><span class="st">            </span><span class="kw">round</span>(., <span class="dt">digits=</span><span class="dv">3</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb151-19" data-line-number="19"></a>
<a class="sourceLine" id="cb151-20" data-line-number="20">zcta_race_proportion &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">zipcode=</span>zcta_race<span class="op">$</span>zipcode, zcta_race_proportion) </a>
<a class="sourceLine" id="cb151-21" data-line-number="21">zcta_race_proportion</a></code></pre></div>
<pre><code>##     zipcode Hisp NH_Black NH_White NH_Asian NH_Other
## 1     11222 14.2      3.7     73.4      5.0      3.7
## 2     11233 16.0     73.6      6.9      1.6      1.8
## 3     11235  8.3      2.3     71.9     14.4      3.1
## 4     11426 18.9      6.1     28.0     44.1      2.7
## 5     11427 19.5     19.7     19.8     31.1      9.9
## 6     11101 26.3     14.5     32.4     22.5      4.2
## 7     11205 17.7     29.5     42.3      6.8      3.7
## 8     11215 16.3      3.8     66.9      7.9      5.1
## 9     11219 12.1      0.9     61.9     24.4      0.6
## 10    11226 17.1     65.2     12.1      2.9      2.7
## 11    11228 13.0      0.9     49.2     35.4      1.6
## 12    11236  7.1     84.2      4.3      2.7      1.7
## 13    11237 63.0      7.5     19.9      7.2      2.4
## 14    11354 15.9      3.0     16.4     62.6      2.0
## 15    11356 40.3      1.5     26.5     29.0      2.7
## 16    11360  9.8      0.8     55.2     32.4      1.9
## 17    11362  8.9      0.8     44.3     43.3      2.8
## 18    11366  8.9      4.9     39.0     45.2      2.2
## 19    11370 37.4     13.8     25.3     22.0      1.5
## 20    11374 16.3      3.9     43.5     31.8      4.5
## 21    11379 20.1      0.9     66.2     11.0      1.9
## 22    11419 18.9     15.7      4.3     32.2     28.9
## 23    11422  9.6     82.5      3.3      2.0      2.6
## 24    11428 25.3     20.3     11.1     25.4     18.0
## 25    11433 18.9     62.0      1.6      8.8      8.7
## 26    11004 12.6      6.6     33.4     42.9      4.6
## 27    11206 37.1     20.9     33.4      6.8      1.8
## 28    11363 13.1      1.6     50.8     32.6      1.9
## 29    11211 24.3      3.7     63.9      5.5      2.5
## 30    11372 57.6      2.4     17.8     20.2      2.0
## 31    11217 18.5     18.7     50.9      7.5      4.3
## 32    11109  5.6      4.1     62.2     25.1      3.0
## 33    11201 11.6     12.6     58.9     11.8      5.2
## 34    11231 18.6     12.2     58.0      5.3      5.9
## 35    11417 38.5      5.8     19.6     28.6      7.5
## 36    11203  6.4     86.2      3.8      1.8      1.7
## 37    11208 41.3     48.8      2.4      5.7      1.8
## 38    11210  7.0     56.9     29.5      4.2      2.4
## 39    11212 18.6     77.4      1.2      1.3      1.5
## 40    11221 34.3     43.4     16.5      3.4      2.5
## 41    11239 18.9     58.7     18.8      2.1      1.4
## 42    11361 12.9      3.6     41.8     40.6      1.2
## 43    10457 66.6     29.5      1.4      0.9      1.6
## 44    10464 25.2      1.9     66.9      5.5      0.5
## 45    10472 64.5     23.8      2.6      6.5      2.6
## 46    10309  9.3      0.6     85.0      3.6      1.5
## 47    10467 52.3     30.4      9.4      5.7      2.1
## 48    10456 61.5     34.3      1.2      0.8      2.1
## 49    10065  6.6      2.0     80.7      9.4      1.3
## 50    10075 14.2      3.1     75.9      4.9      1.9
## 51    10468 75.8     16.2      3.0      2.8      2.2
## 52    10001 14.2      5.6     53.1     25.0      2.1
## 53    10035 44.6     37.0     10.2      4.4      3.8
## 54    10003  8.2      5.4     70.4     13.5      2.4
## 55    10009 24.8      8.5     51.2     12.8      2.7
## 56    10011 11.3      4.7     71.5      9.2      3.3
## 57    10022  5.4      1.2     78.8     12.2      2.4
## 58    10028  7.4      0.8     80.9      9.4      1.4
## 59    10044 13.3     11.1     38.1     33.9      3.7
## 60    10460 69.5     25.3      2.6      1.5      1.1
## 61    10282  7.6      0.8     67.0     20.8      3.9
## 62    10301 24.8     21.2     42.5      6.0      5.6
## 63    10307  9.2      0.4     87.3      2.7      0.4
## 64    10465 44.3      8.9     42.8      2.8      1.3
## 65    10470 21.1     37.0     36.2      3.5      2.2
## 66    10471 22.8     10.4     58.5      5.8      2.4
## 67    10006 12.0      1.0     63.2     19.9      3.9
## 68    10012  6.4      2.5     69.8     17.3      4.0
## 69    10013  6.0      3.6     52.4     33.2      4.7
## 70    10014  6.7      1.0     83.9      5.6      2.8
## 71    10023 10.5      3.8     72.5     10.6      2.6
## 72    10024 10.9      2.9     76.8      7.2      2.2
## 73    10032 66.3     13.6     14.1      4.5      1.6
## 74    10306 14.7      3.1     74.6      5.8      1.7
## 75    10461 46.6      7.7     33.3     10.7      1.8
## 76    10018 15.2      4.5     47.6     29.6      3.2
## 77    10027 25.4     36.8     25.1      9.5      3.2
## 78    10036 21.5      6.3     51.4     19.0      1.7
## 79    10304 25.2     25.2     37.8      9.5      2.2
## 80    10308  9.6      1.0     83.7      5.0      0.7
## 81    10459 67.9     28.9      1.6      0.7      0.9
## 82    10466 22.0     69.1      2.9      3.0      3.1
## 83    10474 63.4     34.9      1.2      0.1      0.4
## 84    10004  3.7      1.6     60.6     29.7      4.5
## 85    10025 23.4      9.9     54.6      8.9      3.2
## 86    10030 25.6     57.2     10.8      1.8      4.6
## 87    10037 21.4     67.8      5.9      2.5      2.4
## 88    10305 16.4      6.2     62.3     12.8      2.3
## 89    10314 15.1      3.7     62.5     16.4      2.3
## 90    10451 59.1     35.4      2.6      1.2      1.7
## 91    10463 51.1     11.2     31.6      3.6      2.4
## 92    10475 29.0     56.8      7.9      2.7      3.5
## 93    10002 27.2      7.0     22.0     41.1      2.7
## 94    10029 47.9     25.8     15.5      9.3      1.5
## 95    10031 51.4     23.7     17.4      3.8      3.7
## 96    10034 69.7      5.4     20.1      3.0      1.7
## 97    10040 69.5      4.9     21.0      2.8      1.8
## 98    10312 10.1      1.2     82.0      5.4      1.3
## 99    10452 68.1     27.0      1.9      1.3      1.6
## 100   10462 47.5     24.8     11.6     12.5      3.5
## 101   10473 60.8     33.4      2.6      1.5      1.6
## 102   10005  6.9      2.5     69.4     17.0      4.2
## 103   10010 11.0      5.1     63.9     17.1      2.8
## 104   10016  6.9      3.5     66.3     19.1      4.2
## 105   10017  5.9      2.2     68.5     21.2      2.1
## 106   10026 21.3     50.3     19.7      5.9      2.9
## 107   10033 68.5      4.1     23.6      2.1      1.7
## 108   10069  1.1      2.9     61.4     30.1      4.4
## 109   10128 12.3      3.0     71.1      9.8      3.8
## 110   10455 71.8     24.3      1.3      1.2      1.3
## 111   10310 31.6     18.9     41.6      6.2      1.7
## 112   10453 69.2     27.4      1.2      1.3      0.9
## 113   10454 67.9     28.1      2.3      0.3      1.2
## 114   10458 69.8     17.4      8.3      2.8      1.7
## 115   10469 29.0     51.9     10.7      6.4      2.0
## 116   10007  8.3      4.2     72.0     11.8      3.8
## 117   10019 16.8      5.3     56.7     17.3      3.9
## 118   10021  7.9      0.6     79.3      9.4      2.8
## 119   10038 14.1      6.8     45.0     31.0      3.1
## 120   10039 33.8     55.1      6.8      1.6      2.7
## 121   10302 41.1     19.2     31.2      7.0      1.5
## 122   10280  8.8      1.7     70.5     15.7      3.3
## 123   10303 38.9     32.9     17.7      8.1      2.4
## 124   11692 24.4     57.0     10.0      5.7      2.9
## 125   11102 30.8      8.6     43.0     15.1      2.6
## 126   11104 31.4      1.2     43.5     21.9      2.0
## 127   11207 33.3     58.8      4.0      1.4      2.5
## 128   11213 10.6     64.2     20.6      1.9      2.7
## 129   11216 10.8     54.7     26.0      5.1      3.4
## 130   11225  8.3     61.1     24.7      2.6      3.3
## 131   11232 50.6      5.0     22.2     19.1      3.1
## 132   11238 10.9     35.4     42.5      6.1      5.1
## 133   11358 16.8      0.5     33.5     47.0      2.1
## 134   11365 19.7      7.4     25.3     44.6      2.9
## 135   11103 22.7      1.9     58.0     14.8      2.7
## 136   11209 16.9      2.7     64.5     13.3      2.5
## 137   11214 16.4      1.2     42.7     37.4      2.3
## 138   11220 41.7      1.6     14.1     41.2      1.4
## 139   11230 10.2      6.9     66.0     14.1      2.8
## 140   11355 14.8      2.9      7.5     72.6      2.3
## 141   11377 38.1      1.9     21.0     36.8      2.3
## 142   11378 32.2      1.4     54.1     10.3      2.0
## 143   11411  6.6     90.5      1.0      0.3      1.6
## 144   11416 45.1      4.8     12.7     33.1      4.3
## 145   11423 14.2     38.5      8.9     28.5      9.9
## 146   11364  9.6      2.1     34.0     51.9      2.4
## 147   11413  4.9     90.0      1.5      1.1      2.5
## 148   11429 12.4     74.0      1.6      4.1      7.9
## 149   11434  7.5     84.9      1.6      2.5      3.5
## 150   11436 14.8     59.7      1.5     10.4     13.6
## 151   11105 22.0      2.1     60.9     12.2      2.8
## 152   11106 28.3      6.0     41.1     20.7      3.9
## 153   11229 10.8      5.1     59.4     22.1      2.6
## 154   11234 10.5     43.6     37.5      6.6      1.8
## 155   11357 15.6      0.5     59.8     22.0      2.1
## 156   11367 17.9      7.4     46.4     25.5      2.9
## 157   11369 63.6     14.8      8.1     12.3      1.2
## 158   11415 24.9      5.0     46.5     19.0      4.6
## 159   11418 45.7      6.4     16.4     23.9      7.6
## 160   11421 58.6      3.0     16.8     19.3      2.2
## 161   11432 24.4     14.7     12.9     41.3      6.6
## 162   11375 15.7      2.5     50.0     27.9      3.9
## 163   11420 24.0     23.0      4.9     31.0     17.1
## 164   11435 31.1     22.4     11.4     24.3     10.9
## 165   11691 26.4     44.3     24.0      3.5      2.0
## 166   11368 75.5      8.3      3.9     11.2      1.1
## 167   11385 44.3      1.6     46.1      6.7      1.3
## 168   11412  5.1     88.3      0.8      2.3      3.6
## 169   11414 22.3      1.8     67.8      5.0      3.0
## 170   11694 14.9      6.0     73.0      3.5      2.6
## 171   11697  6.5      0.6     91.6      0.6      0.8
## 172   11204 10.9      1.1     54.4     31.7      1.9
## 173   11218 17.6      7.6     52.5     18.5      3.9
## 174   11223 16.7      3.5     52.1     24.1      3.5
## 175   11224 20.4     20.6     51.0      5.9      2.1
## 176   11373 41.4      1.8      6.5     48.3      2.1
## 177   11693 29.5     16.1     46.9      4.0      3.5</code></pre>
</div>
<div id="some-more-variables-to-play-with" class="section level3">
<h3><span class="header-section-number">16.0.3</span> Some more variables to play with</h3>
<div id="household-size" class="section level4">
<h4><span class="header-section-number">16.0.3.1</span> Household size</h4>
<ul>
<li>B08201_007E Estimate!!Total!!1-person household</li>
<li>B08201_013E Estimate!!Total!!2-person household</li>
<li>B08201_019E Estimate!!Total!!3-person household</li>
<li>B08201_025E Estimate!!Total!!4-or-more-person household</li>
</ul>
</div>
<div id="educational-attainment" class="section level4">
<h4><span class="header-section-number">16.0.3.2</span> Educational attainment</h4>
<ul>
<li>B15003_022E Estimate!!Total!!Bachelor’s degree<br />
</li>
<li>B15003_023E Estimate!!Total!!Master’s degree<br />
</li>
<li>B15003_024E Estimate!!Total!!Professional school degree</li>
<li>B15003_025E Estimate!!Total!!Doctorate degree</li>
</ul>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1">zcta_college_hh &lt;-<span class="st"> </span><span class="kw">getCensus</span>(<span class="dt">name =</span> <span class="st">&quot;acs/acs5&quot;</span>,</a>
<a class="sourceLine" id="cb153-2" data-line-number="2">                             <span class="dt">vintage =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb153-3" data-line-number="3">                             <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;B15003_022E&quot;</span>, <span class="st">&quot;B15003_023E&quot;</span>, <span class="st">&quot;B15003_024E&quot;</span>, </a>
<a class="sourceLine" id="cb153-4" data-line-number="4">                                      <span class="st">&quot;B15003_025E&quot;</span>, <span class="st">&quot;B15003_001E&quot;</span>,</a>
<a class="sourceLine" id="cb153-5" data-line-number="5">                                      <span class="st">&quot;B08201_007E&quot;</span>, <span class="st">&quot;B08201_013E&quot;</span>, <span class="st">&quot;B08201_019E&quot;</span>, <span class="st">&quot;B08201_025E&quot;</span>),</a>
<a class="sourceLine" id="cb153-6" data-line-number="6">                             <span class="dt">region =</span> <span class="kw">paste0</span>(<span class="st">&quot;zip code tabulation area:&quot;</span>,nyc_zipcode_string),</a>
<a class="sourceLine" id="cb153-7" data-line-number="7">                             <span class="dt">key =</span> myKey</a>
<a class="sourceLine" id="cb153-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb153-9" data-line-number="9"></a>
<a class="sourceLine" id="cb153-10" data-line-number="10"><span class="co"># give variable names</span></a>
<a class="sourceLine" id="cb153-11" data-line-number="11"><span class="kw">names</span>(zcta_college_hh) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;zipcode&quot;</span>, <span class="st">&quot;Bachelors&quot;</span>, <span class="st">&quot;Masters&quot;</span>, <span class="st">&quot;Professional&quot;</span>, <span class="st">&quot;Doctorate&quot;</span>, </a>
<a class="sourceLine" id="cb153-12" data-line-number="12">                           <span class="st">&quot;TotalPop&quot;</span>,</a>
<a class="sourceLine" id="cb153-13" data-line-number="13">                        <span class="st">&quot;HH1pers&quot;</span>, <span class="st">&quot;HH2pers&quot;</span>, <span class="st">&quot;HH3pers&quot;</span>, <span class="st">&quot;HH4plus&quot;</span>)</a>
<a class="sourceLine" id="cb153-14" data-line-number="14"></a>
<a class="sourceLine" id="cb153-15" data-line-number="15"><span class="co"># create the Bach_plus Other category</span></a>
<a class="sourceLine" id="cb153-16" data-line-number="16">zcta_edu_hh &lt;-<span class="st"> </span>zcta_college_hh <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-17" data-line-number="17"><span class="st">                  </span><span class="kw">mutate</span>(<span class="dt">Bach_plus_prop =</span></a>
<a class="sourceLine" id="cb153-18" data-line-number="18">                           <span class="kw">round</span>((Bachelors<span class="op">+</span>Masters<span class="op">+</span>Professional<span class="op">+</span>Doctorate)<span class="op">/</span>TotalPop,<span class="dv">3</span>)<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb153-19" data-line-number="19"><span class="co"># create the average household size variable</span></a>
<a class="sourceLine" id="cb153-20" data-line-number="20">zcta_edu_hh &lt;-<span class="st"> </span>zcta_edu_hh <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-21" data-line-number="21"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">AvgHH =</span> (HH1pers<span class="op">+</span><span class="dv">2</span><span class="op">*</span>HH2pers<span class="op">+</span><span class="dv">3</span><span class="op">*</span>HH3pers<span class="op">+</span><span class="dv">4</span><span class="op">*</span>HH4plus)<span class="op">/</span>(HH1pers<span class="op">+</span>HH2pers<span class="op">+</span>HH3pers<span class="op">+</span>HH4plus)) </a>
<a class="sourceLine" id="cb153-22" data-line-number="22"></a>
<a class="sourceLine" id="cb153-23" data-line-number="23"></a>
<a class="sourceLine" id="cb153-24" data-line-number="24"></a>
<a class="sourceLine" id="cb153-25" data-line-number="25"><span class="kw">head</span>(zcta_edu_hh)</a></code></pre></div>
<pre><code>##   zipcode Bachelors Masters Professional Doctorate TotalPop HH1pers HH2pers
## 1   11222     11797    4846          814       271    30177    6139    6777
## 2   11233      8449    3310          430       321    49821    9476    8429
## 3   11235     16573    8694         2083      1053    59442   10886    9914
## 4   11426      3192    1711          455       143    14569    1256    1757
## 5   11427      3395    1651          372       153    17320    1691    1938
## 6   11101      6342    2746         1145       394    22131    4692    4919
##   HH3pers HH4plus Bach_plus_prop    AvgHH
## 1    2419    1921           58.7 2.007070
## 2    5052    6388           25.1 2.284614
## 3    4816    6653           47.8 2.224240
## 4     924    2419           37.8 2.708936
## 5    1318    2553           32.2 2.631067
## 6    1809    1749           48.0 2.046701</code></pre>

</div>
</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="nyc-covid-19-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-randomness.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["carpedatum.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
